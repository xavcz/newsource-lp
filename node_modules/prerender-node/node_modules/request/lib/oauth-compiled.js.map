{"version":3,"sources":["oauth.js"],"names":[],"mappings":"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","file":"oauth-compiled.js","sourcesContent":["'use strict'\n\nvar url = require('url')\n  , qs = require('qs')\n  , caseless = require('caseless')\n  , uuid = require('node-uuid')\n  , oauth = require('oauth-sign')\n  , crypto = require('crypto')\n\n\nfunction OAuth (request) {\n  this.request = request\n  this.params = null\n}\n\nOAuth.prototype.buildParams = function (_oauth, uri, method, query, form, qsLib) {\n  var oa = {}\n  for (var i in _oauth) {\n    oa['oauth_' + i] = _oauth[i]\n  }\n  if (!oa.oauth_version) {\n    oa.oauth_version = '1.0'\n  }\n  if (!oa.oauth_timestamp) {\n    oa.oauth_timestamp = Math.floor( Date.now() / 1000 ).toString()\n  }\n  if (!oa.oauth_nonce) {\n    oa.oauth_nonce = uuid().replace(/-/g, '')\n  }\n  if (!oa.oauth_signature_method) {\n    oa.oauth_signature_method = 'HMAC-SHA1'\n  }\n\n  var consumer_secret_or_private_key = oa.oauth_consumer_secret || oa.oauth_private_key\n  delete oa.oauth_consumer_secret\n  delete oa.oauth_private_key\n\n  var token_secret = oa.oauth_token_secret\n  delete oa.oauth_token_secret\n\n  var realm = oa.oauth_realm\n  delete oa.oauth_realm\n  delete oa.oauth_transport_method\n\n  var baseurl = uri.protocol + '//' + uri.host + uri.pathname\n  var params = qsLib.parse([].concat(query, form, qsLib.stringify(oa)).join('&'))\n\n  oa.oauth_signature = oauth.sign(\n    oa.oauth_signature_method,\n    method,\n    baseurl,\n    params,\n    consumer_secret_or_private_key,\n    token_secret)\n\n  if (realm) {\n    oa.realm = realm\n  }\n\n  return oa\n}\n\nOAuth.prototype.buildBodyHash = function(_oauth, body) {\n  if (['HMAC-SHA1', 'RSA-SHA1'].indexOf(_oauth.signature_method || 'HMAC-SHA1') < 0) {\n    this.request.emit('error', new Error('oauth: ' + _oauth.signature_method +\n      ' signature_method not supported with body_hash signing.'))\n  }\n\n  var shasum = crypto.createHash('sha1')\n  shasum.update(body || '')\n  var sha1 = shasum.digest('hex')\n\n  return new Buffer(sha1).toString('base64')\n}\n\nOAuth.prototype.concatParams = function (oa, sep, wrap) {\n  wrap = wrap || ''\n\n  var params = Object.keys(oa).filter(function (i) {\n    return i !== 'realm' && i !== 'oauth_signature'\n  }).sort()\n\n  if (oa.realm) {\n    params.splice(0, 0, 'realm')\n  }\n  params.push('oauth_signature')\n\n  return params.map(function (i) {\n    return i + '=' + wrap + oauth.rfc3986(oa[i]) + wrap\n  }).join(sep)\n}\n\nOAuth.prototype.onRequest = function (_oauth) {\n  var self = this\n  self.params = _oauth\n\n  var uri = self.request.uri || {}\n    , method = self.request.method || ''\n    , headers = caseless(self.request.headers)\n    , body = self.request.body || ''\n    , qsLib = self.request.qsLib || qs\n\n  var form\n    , query\n    , contentType = headers.get('content-type') || ''\n    , formContentType = 'application/x-www-form-urlencoded'\n    , transport = _oauth.transport_method || 'header'\n\n  if (contentType.slice(0, formContentType.length) === formContentType) {\n    contentType = formContentType\n    form = body\n  }\n  if (uri.query) {\n    query = uri.query\n  }\n  if (transport === 'body' && (method !== 'POST' || contentType !== formContentType)) {\n    self.request.emit('error', new Error('oauth: transport_method of body requires POST ' +\n      'and content-type ' + formContentType))\n  }\n\n  if (!form && typeof _oauth.body_hash === 'boolean') {\n    _oauth.body_hash = self.buildBodyHash(_oauth, self.request.body.toString())\n  }\n\n  var oa = self.buildParams(_oauth, uri, method, query, form, qsLib)\n\n  switch (transport) {\n    case 'header':\n      self.request.setHeader('Authorization', 'OAuth ' + self.concatParams(oa, ',', '\"'))\n      break\n\n    case 'query':\n      var href = self.request.uri.href += (query ? '&' : '?') + self.concatParams(oa, '&')\n      self.request.uri = url.parse(href)\n      self.request.path = self.request.uri.path\n      break\n\n    case 'body':\n      self.request.body = (form ? form + '&' : '') + self.concatParams(oa, '&')\n      break\n\n    default:\n      self.request.emit('error', new Error('oauth: transport_method invalid'))\n  }\n}\n\nexports.OAuth = OAuth\n"]}