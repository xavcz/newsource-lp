{"version":3,"sources":["usage.js"],"names":[],"mappings":";;;;AAEA,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AACjC,IAAI,IAAI,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;;;;AAK7B,IAAI,SAAS,GAAG;AACZ,eAAW,EAAE;AACT,oBAAY,EAAE;AACV,cAAE,EAAE,cAAc;AAClB,eAAG,EAAE,6CAA6C;AAClD,qBAAS,EAAE,QAAQ;AACnB,gBAAI,EAAE,OAAO;SAChB;KACJ;CACJ,CAAC;;;;AAKF,IAAI,eAAe,GAAG,SAAlB,eAAe,CAAa,EAAE,EAAE,QAAQ,EAAE;;AAE1C,WAAO,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;CACpD,CAAC;;;;AAKF,IAAI,OAAO,GAAG,SAAV,OAAO,CAAa,GAAG,EAAE,GAAG,EAAE;;AAE9B,QAAI,CAAC,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,eAAe,EAAE,EAAE,EAAE,UAAU,GAAG,EAAE,WAAW,EAAE,SAAS,EAAE;;AAEtF,YAAI,OAAO,GAAI,CAAC,GAAG,GAAG,QAAQ,GAAG,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,AAAC,CAAC;AACrF,YAAI,OAAO,GAAG;AACV,0BAAc,EAAE,YAAY;AAC5B,kCAAsB,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,SAAS,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,YAAY,EAAE,CAAC;SACtH,CAAC;;AAEF,WAAG,CAAC,SAAS,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,OAAO,CAAC,CAAC;AACzC,WAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;KACpB,CAAC,CAAC;CACN,CAAC;;AAEF,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;;;;AAKrD,OAAO,CAAC,0CAA0C,EAAE,UAAU,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE;;AAEjF,WAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;CAClD,CAAC,CAAC;;;;AAKH,eAAe,CAAC,cAAc,EAAE,UAAU,GAAG,EAAE,WAAW,EAAE;;AAExD,QAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,0CAA0C,EAAE,KAAK,EAAE,EAAE,WAAW,EAAE,WAAW,EAAE,GAAG,EAAE,cAAc,EAAE,CAAC,CAAC;AACtI,QAAI,OAAO,GAAG;AACV,WAAG,EAAE,0CAA0C;AAC/C,cAAM,EAAE,KAAK;AACb,eAAO,EAAE;AACL,yBAAa,EAAE,MAAM,CAAC,KAAK;SAC9B;KACJ,CAAC;;AAEF,WAAO,CAAC,OAAO,EAAE,UAAU,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE;;AAE9C,YAAI,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,EAAE,WAAW,EAAE,MAAM,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;AACnG,eAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,GAAG,IAAI,GAAG,IAAI,IAAI,OAAO,GAAG,UAAU,GAAG,YAAY,CAAA,AAAC,CAAC,CAAC;AACvF,eAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KACnB,CAAC,CAAC;CACN,CAAC,CAAC","file":"usage-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Http = require('http');\r\nvar Request = require('request');\r\nvar Hawk = require('../lib');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {\r\n    credentials: {\r\n        dh37fgj492je: {\r\n            id: 'dh37fgj492je',                                             // Required by Hawk.client.header\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: 'sha256',\r\n            user: 'Steve'\r\n        }\r\n    }\r\n};\r\n\r\n\r\n// Credentials lookup function\r\n\r\nvar credentialsFunc = function (id, callback) {\r\n\r\n    return callback(null, internals.credentials[id]);\r\n};\r\n\r\n\r\n// Create HTTP server\r\n\r\nvar handler = function (req, res) {\r\n\r\n    Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n        var payload = (!err ? 'Hello ' + credentials.user + ' ' + artifacts.ext : 'Shoosh!');\r\n        var headers = {\r\n            'Content-Type': 'text/plain',\r\n            'Server-Authorization': Hawk.server.header(credentials, artifacts, { payload: payload, contentType: 'text/plain' })\r\n        };\r\n\r\n        res.writeHead(!err ? 200 : 401, headers);\r\n        res.end(payload);\r\n    });\r\n};\r\n\r\nHttp.createServer(handler).listen(8000, '127.0.0.1');\r\n\r\n\r\n// Send unauthenticated request\r\n\r\nRequest('http://127.0.0.1:8000/resource/1?b=1&a=2', function (error, response, body) {\r\n\r\n    console.log(response.statusCode + ': ' + body);\r\n});\r\n\r\n\r\n// Send authenticated request\r\n\r\ncredentialsFunc('dh37fgj492je', function (err, credentials) {\r\n\r\n    var header = Hawk.client.header('http://127.0.0.1:8000/resource/1?b=1&a=2', 'GET', { credentials: credentials, ext: 'and welcome!' });\r\n    var options = {\r\n        uri: 'http://127.0.0.1:8000/resource/1?b=1&a=2',\r\n        method: 'GET',\r\n        headers: {\r\n            authorization: header.field\r\n        }\r\n    };\r\n\r\n    Request(options, function (error, response, body) {\r\n\r\n        var isValid = Hawk.client.authenticate(response, credentials, header.artifacts, { payload: body });\r\n        console.log(response.statusCode + ': ' + body + (isValid ? ' (valid)' : ' (invalid)'));\r\n        process.exit(0);\r\n    });\r\n});\r\n\r\n"]}