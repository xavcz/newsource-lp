{"version":3,"sources":["server.js"],"names":[],"mappings":"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","file":"server-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Url = require('url');\r\nvar Code = require('code');\r\nvar Hawk = require('../lib');\r\nvar Hoek = require('hoek');\r\nvar Lab = require('lab');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {};\r\n\r\n\r\n// Test shortcuts\r\n\r\nvar lab = exports.lab = Lab.script();\r\nvar describe = lab.experiment;\r\nvar it = lab.test;\r\nvar expect = Code.expect;\r\n\r\n\r\ndescribe('Server', function () {\r\n\r\n    var credentialsFunc = function (id, callback) {\r\n\r\n        var credentials = {\r\n            id: id,\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: (id === '1' ? 'sha1' : 'sha256'),\r\n            user: 'steve'\r\n        };\r\n\r\n        return callback(null, credentials);\r\n    };\r\n\r\n    describe('authenticate()', function () {\r\n\r\n        it('parses a valid authentication header (sha1)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"1\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"zy79QQ5/EYFmQqutVnYb73gAc/U=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('parses a valid authentication header (sha256)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/1?b=1&a=2',\r\n                host: 'example.com',\r\n                port: 8000,\r\n                authorization: 'Hawk id=\"dh37fgj492je\", ts=\"1353832234\", nonce=\"j4h3g2\", mac=\"m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\", ext=\"some-app-data\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353832234000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('parses a valid authentication header (host override)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                headers: {\r\n                    host: 'example1.com:8080',\r\n                    authorization: 'Hawk id=\"1\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"zy79QQ5/EYFmQqutVnYb73gAc/U=\", ext=\"hello\"'\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { host: 'example.com', localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('parses a valid authentication header (host port override)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                headers: {\r\n                    host: 'example1.com:80',\r\n                    authorization: 'Hawk id=\"1\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"zy79QQ5/EYFmQqutVnYb73gAc/U=\", ext=\"hello\"'\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { host: 'example.com', port: 8080, localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('parses a valid authentication header (POST with payload)', function (done) {\r\n\r\n            var req = {\r\n                method: 'POST',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123456\", ts=\"1357926341\", nonce=\"1AwuJD\", hash=\"qAiXIVv+yjDATneWxZP2YCTa9aHRgQdnH9b3Wc+o3dg=\", ext=\"some-app-data\", mac=\"UeYcj5UoTVaAWXNvJfLVia7kU3VabxCqrccXP8sUGC4=\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1357926341000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on missing hash', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/1?b=1&a=2',\r\n                host: 'example.com',\r\n                port: 8000,\r\n                authorization: 'Hawk id=\"dh37fgj492je\", ts=\"1353832234\", nonce=\"j4h3g2\", mac=\"m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\", ext=\"some-app-data\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { payload: 'body', localtimeOffsetMsec: 1353832234000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Missing required payload hash');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on a stale timestamp', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123456\", ts=\"1362337299\", nonce=\"UzmxSs\", ext=\"some-app-data\", mac=\"wnNUxchvvryMH2RxckTdZ/gY3ijzvccx4keVvELC61w=\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Stale timestamp');\r\n                var header = err.output.headers['WWW-Authenticate'];\r\n                var ts = header.match(/^Hawk ts\\=\\\"(\\d+)\\\"\\, tsm\\=\\\"([^\\\"]+)\\\"\\, error=\\\"Stale timestamp\\\"$/);\r\n                var now = Hawk.utils.now();\r\n                expect(parseInt(ts[1], 10) * 1000).to.be.within(now - 1000, now + 1000);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': header\r\n                    }\r\n                };\r\n\r\n                expect(Hawk.client.authenticate(res, credentials, artifacts)).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on a replay', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"bXx7a7p1h9QYQNZ8x7QhvDQym8ACgab4m3lVSFn4DBw=\", ext=\"hello\"'\r\n            };\r\n\r\n            var memoryCache = {};\r\n            var options = {\r\n                localtimeOffsetMsec: 1353788437000 - Hawk.utils.now(),\r\n                nonceFunc: function (key, nonce, ts, callback) {\r\n\r\n                    if (memoryCache[key + nonce]) {\r\n                        return callback(new Error());\r\n                    }\r\n\r\n                    memoryCache[key + nonce] = true;\r\n                    return callback();\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, options, function (err, credentials1, artifacts1) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials1.user).to.equal('steve');\r\n\r\n                Hawk.server.authenticate(req, credentialsFunc, options, function (err, credentials2, artifacts2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.output.payload.message).to.equal('Invalid nonce');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('does not error on nonce collision if keys differ', function (done) {\r\n\r\n            var reqSteve = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"bXx7a7p1h9QYQNZ8x7QhvDQym8ACgab4m3lVSFn4DBw=\", ext=\"hello\"'\r\n            };\r\n\r\n            var reqBob = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"456\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"LXfmTnRzrLd9TD7yfH+4se46Bx6AHyhpM94hLCiNia4=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                var credentials = {\r\n                    '123': {\r\n                        id: id,\r\n                        key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                        algorithm: (id === '1' ? 'sha1' : 'sha256'),\r\n                        user: 'steve'\r\n                    },\r\n                    '456': {\r\n                        id: id,\r\n                        key: 'xrunpaw3489ruxnpa98w4rxnwerxhqb98rpaxn39848',\r\n                        algorithm: (id === '1' ? 'sha1' : 'sha256'),\r\n                        user: 'bob'\r\n                    }\r\n                };\r\n\r\n                return callback(null, credentials[id]);\r\n            };\r\n\r\n            var memoryCache = {};\r\n            var options = {\r\n                localtimeOffsetMsec: 1353788437000 - Hawk.utils.now(),\r\n                nonceFunc: function (key, nonce, ts, callback) {\r\n\r\n                    if (memoryCache[key + nonce]) {\r\n                        return callback(new Error());\r\n                    }\r\n\r\n                    memoryCache[key + nonce] = true;\r\n                    return callback();\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(reqSteve, credentialsFuncion, options, function (err, credentials1, artifacts1) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials1.user).to.equal('steve');\r\n\r\n                Hawk.server.authenticate(reqBob, credentialsFuncion, options, function (err, credentials2, artifacts2) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    expect(credentials2.user).to.equal('bob');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('errors on an invalid authentication header: wrong scheme', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Basic asdasdasdasd'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.not.exist();\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an invalid authentication header: no scheme', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: '!@#'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid header syntax');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing authorization header', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.isMissing).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing host header', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                headers: {\r\n                    authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid Host header');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing authorization attribute (id)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Missing attributes');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing authorization attribute (ts)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Missing attributes');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing authorization attribute (nonce)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Missing attributes');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an missing authorization attribute (mac)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Missing attributes');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an unknown authorization attribute', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", x=\"3\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Unknown attribute: x');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an bad authorization header format', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\\\\\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Bad header format');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an bad authorization attribute value', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"\\t\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Bad attribute value: id');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an empty authorization attribute value', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Bad attribute value: id');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on duplicated authorization attribute key', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", id=\"456\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Duplicate attribute: id');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an invalid authorization header format', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk'\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid header syntax');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an bad host header (missing host)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                headers: {\r\n                    host: ':8080',\r\n                    authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid Host header');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on an bad host header (pad port)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                headers: {\r\n                    host: 'example.com:something',\r\n                    authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n                }\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid Host header');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on credentialsFunc error', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                return callback(new Error('Unknown user'));\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Unknown user');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on credentialsFunc error (with credentials)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                return callback(new Error('Unknown user'), { some: 'value' });\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Unknown user');\r\n                expect(credentials.some).to.equal('value');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on missing credentials', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                return callback(null, null);\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Unknown credentials');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on invalid credentials (id)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                var credentials = {\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    user: 'steve'\r\n                };\r\n\r\n                return callback(null, credentials);\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Invalid credentials');\r\n                expect(err.output.payload.message).to.equal('An internal server error occurred');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on invalid credentials (key)', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                var credentials = {\r\n                    id: '23434d3q4d5345d',\r\n                    user: 'steve'\r\n                };\r\n\r\n                return callback(null, credentials);\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Invalid credentials');\r\n                expect(err.output.payload.message).to.equal('An internal server error occurred');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on unknown credentials algorithm', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                var credentials = {\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'hmac-sha-0',\r\n                    user: 'steve'\r\n                };\r\n\r\n                return callback(null, credentials);\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Unknown algorithm');\r\n                expect(err.output.payload.message).to.equal('An internal server error occurred');\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('errors on unknown bad mac', function (done) {\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"123\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"/qwS4UjfVWMcU4jlr7T/wuKe3dKijvTvSos=\", ext=\"hello\"'\r\n            };\r\n\r\n            var credentialsFuncion = function (id, callback) {\r\n\r\n                var credentials = {\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'sha256',\r\n                    user: 'steve'\r\n                };\r\n\r\n                return callback(null, credentials);\r\n            };\r\n\r\n            Hawk.server.authenticate(req, credentialsFuncion, { localtimeOffsetMsec: 1353788437000 - Hawk.utils.now() }, function (err, credentials, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Bad mac');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('header()', function () {\r\n\r\n        it('generates header', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('Hawk mac=\\\"n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\\\", hash=\\\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\\\", ext=\\\"response-specific\\\"');\r\n            done();\r\n        });\r\n\r\n        it('generates header (empty payload)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, artifacts, { payload: '', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('Hawk mac=\\\"i8/kUBDx0QF+PpCtW860kkV/fa9dbwEoe/FpGUXowf0=\\\", hash=\\\"q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\\\", ext=\\\"response-specific\\\"');\r\n            done();\r\n        });\r\n\r\n        it('generates header (pre calculated hash)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var options = { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' };\r\n            options.hash = Hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, options.contentType);\r\n            var header = Hawk.server.header(credentials, artifacts, options);\r\n            expect(header).to.equal('Hawk mac=\\\"n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\\\", hash=\\\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\\\", ext=\\\"response-specific\\\"');\r\n            done();\r\n        });\r\n\r\n        it('generates header (null ext)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: null });\r\n            expect(header).to.equal('Hawk mac=\\\"6PrybJTJs20jsgBw5eilXpcytD8kUbaIKNYXL+6g0ns=\\\", hash=\\\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\\\"');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing artifacts', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, null, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid artifacts', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, 5, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing credentials', function (done) {\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(null, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (key)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                algorithm: 'sha256',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid algorithm', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                algorithm: 'x',\r\n                user: 'steve'\r\n            };\r\n\r\n            var artifacts = {\r\n                method: 'POST',\r\n                host: 'example.com',\r\n                port: '8080',\r\n                resource: '/resource/4?filter=a',\r\n                ts: '1398546787',\r\n                nonce: 'xUwusx',\r\n                hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                ext: 'some-app-data',\r\n                mac: 'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=',\r\n                id: '123456'\r\n            };\r\n\r\n            var header = Hawk.server.header(credentials, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n            expect(header).to.equal('');\r\n            done();\r\n        });\r\n    });\r\n\r\n    describe('authenticateBewit()', function () {\r\n\r\n        it('errors on uri too long', function (done) {\r\n\r\n            var long = '/';\r\n            for (var i = 0; i < 5000; ++i) {\r\n                long += 'x';\r\n            }\r\n\r\n            var req = {\r\n                method: 'GET',\r\n                url: long,\r\n                host: 'example.com',\r\n                port: 8080,\r\n                authorization: 'Hawk id=\"1\", ts=\"1353788437\", nonce=\"k3j4h2\", mac=\"zy79QQ5/EYFmQqutVnYb73gAc/U=\", ext=\"hello\"'\r\n            };\r\n\r\n            Hawk.server.authenticateBewit(req, credentialsFunc, {}, function (err, credentials, bewit) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.statusCode).to.equal(400);\r\n                expect(err.message).to.equal('Resource path exceeds max length');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('authenticateMessage()', function () {\r\n\r\n        it('errors on invalid authorization (ts)', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                delete auth.ts;\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid authorization');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('errors on invalid authorization (nonce)', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                delete auth.nonce;\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid authorization');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('errors on invalid authorization (hash)', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                delete auth.hash;\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid authorization');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('errors with credentials', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, function (id, callback) {\r\n\r\n                    callback(new Error('something'), { some: 'value' });\r\n                }, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('something');\r\n                    expect(credentials2.some).to.equal('value');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('errors on nonce collision', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {\r\n                    nonceFunc: function (key, nonce, ts, nonceCallback) {\r\n\r\n                        nonceCallback(true);\r\n                    }\r\n                }, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid nonce');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should generate an authorization then successfully parse it', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    expect(credentials2.user).to.equal('steve');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on mismatching host', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example1.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Bad mac');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on stale timestamp', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, { localtimeOffsetMsec: 100000 }, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Stale timestamp');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('overrides timestampSkewSec', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1, localtimeOffsetMsec: 100000 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, { timestampSkewSec: 500 }, function (err, credentials2) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid authorization', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n                delete auth.id;\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid authorization');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on bad hash', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message1', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Bad message hash');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on nonce error', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {\r\n                    nonceFunc: function (key, nonce, ts, callback) {\r\n\r\n                        callback(new Error('kaboom'));\r\n                    }\r\n                }, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid nonce');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on credentials error', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(new Error('kablooey'));\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('kablooey');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on missing credentials', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback();\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Unknown credentials');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid credentials', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(null, {});\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid credentials');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid credentials algorithm', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(null, { key: '123', algorithm: '456' });\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Unknown algorithm');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail on missing host', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials) {\r\n\r\n                var auth = Hawk.client.message(null, 8080, 'some message', { credentials: credentials });\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('should fail on missing credentials', function (done) {\r\n\r\n            var auth = Hawk.client.message('example.com', 8080, 'some message', {});\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('should fail on invalid algorithm', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials) {\r\n\r\n                var creds = Hoek.clone(credentials);\r\n                creds.algorithm = 'blah';\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: creds });\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('authenticatePayloadHash()', function () {\r\n\r\n        it('checks payload hash', function (done) {\r\n\r\n            expect(Hawk.server.authenticatePayloadHash('abcdefg', { hash: 'abcdefg' })).to.equal(true);\r\n            expect(Hawk.server.authenticatePayloadHash('1234567', { hash: 'abcdefg' })).to.equal(false);\r\n            done();\r\n        });\r\n    });\r\n});\r\n\r\n"]}