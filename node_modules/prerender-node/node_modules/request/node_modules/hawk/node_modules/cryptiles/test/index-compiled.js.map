{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["// Load modules\n\nvar Code = require('code');\nvar Cryptiles = require('..');\nvar Lab = require('lab');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Test shortcuts\n\nvar lab = exports.lab = Lab.script();\nvar describe = lab.describe;\nvar it = lab.it;\nvar expect = Code.expect;\n\n\ndescribe('randomString()', function () {\n\n    it('should generate the right length string', function (done) {\n\n        for (var i = 1; i <= 1000; ++i) {\n            expect(Cryptiles.randomString(i).length).to.equal(i);\n        }\n\n        done();\n    });\n\n    it('returns an error on invalid bits size', function (done) {\n\n        expect(Cryptiles.randomString(99999999999999999999).message).to.match(/Failed generating random bits/);\n        done();\n    });\n});\n\ndescribe('randomBits()', function () {\n\n    it('returns an error on invalid input', function (done) {\n\n        expect(Cryptiles.randomBits(0).message).to.equal('Invalid random bits count');\n        done();\n    });\n});\n\ndescribe('fixedTimeComparison()', function () {\n\n    var a = Cryptiles.randomString(50000);\n    var b = Cryptiles.randomString(150000);\n\n    it('should take the same amount of time comparing different string sizes', function (done) {\n\n        var now = Date.now();\n        Cryptiles.fixedTimeComparison(b, a);\n        var t1 = Date.now() - now;\n\n        now = Date.now();\n        Cryptiles.fixedTimeComparison(b, b);\n        var t2 = Date.now() - now;\n\n        expect(t2 - t1).to.be.within(-20, 20);\n        done();\n    });\n\n    it('should return true for equal strings', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a, a)).to.equal(true);\n        done();\n    });\n\n    it('should return false for different strings (size, a < b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a, a + 'x')).to.equal(false);\n        done();\n    });\n\n    it('should return false for different strings (size, a > b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a + 'x', a)).to.equal(false);\n        done();\n    });\n\n    it('should return false for different strings (size, a = b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a + 'x', a + 'y')).to.equal(false);\n        done();\n    });\n\n    it('should return false when not a string', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison('x', null)).to.equal(false);\n        done();\n    });\n\n    it('should return false when not a string (left)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(null, 'x')).to.equal(false);\n        done();\n    });\n});\n"]}