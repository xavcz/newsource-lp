{"version":3,"sources":["ed-compat.js"],"names":[],"mappings":"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","file":"ed-compat-compiled.js","sourcesContent":["// Copyright 2015 Joyent, Inc.\n\nmodule.exports = {\n\tVerifier: Verifier,\n\tSigner: Signer\n};\n\nvar nacl;\nvar stream = require('stream');\nvar util = require('util');\nvar assert = require('assert-plus');\nvar Signature = require('./signature');\n\nfunction Verifier(key, hashAlgo) {\n\tif (nacl === undefined)\n\t\tnacl = require('tweetnacl');\n\n\tif (hashAlgo.toLowerCase() !== 'sha512')\n\t\tthrow (new Error('ED25519 only supports the use of ' +\n\t\t    'SHA-512 hashes'));\n\n\tthis.key = key;\n\tthis.chunks = [];\n\n\tstream.Writable.call(this, {});\n}\nutil.inherits(Verifier, stream.Writable);\n\nVerifier.prototype._write = function (chunk, enc, cb) {\n\tthis.chunks.push(chunk);\n\tcb();\n};\n\nVerifier.prototype.update = function (chunk) {\n\tif (typeof (chunk) === 'string')\n\t\tchunk = new Buffer(chunk, 'binary');\n\tthis.chunks.push(chunk);\n};\n\nVerifier.prototype.verify = function (signature, fmt) {\n\tvar sig;\n\tif (Signature.isSignature(signature, [2, 0])) {\n\t\tif (signature.type !== 'ed25519')\n\t\t\treturn (false);\n\t\tsig = signature.toBuffer('raw');\n\n\t} else if (typeof (signature) === 'string') {\n\t\tsig = new Buffer(signature, 'base64');\n\n\t} else if (Signature.isSignature(signature, [1, 0])) {\n\t\tthrow (new Error('signature was created by too old ' +\n\t\t    'a version of sshpk and cannot be verified'));\n\t}\n\n\tassert.buffer(sig);\n\treturn (nacl.sign.detached.verify(\n\t    new Uint8Array(Buffer.concat(this.chunks)),\n\t    new Uint8Array(sig),\n\t    new Uint8Array(this.key.part.R.data)));\n};\n\nfunction Signer(key, hashAlgo) {\n\tif (nacl === undefined)\n\t\tnacl = require('tweetnacl');\n\n\tif (hashAlgo.toLowerCase() !== 'sha512')\n\t\tthrow (new Error('ED25519 only supports the use of ' +\n\t\t    'SHA-512 hashes'));\n\n\tthis.key = key;\n\tthis.chunks = [];\n\n\tstream.Writable.call(this, {});\n}\nutil.inherits(Signer, stream.Writable);\n\nSigner.prototype._write = function (chunk, enc, cb) {\n\tthis.chunks.push(chunk);\n\tcb();\n};\n\nSigner.prototype.update = function (chunk) {\n\tif (typeof (chunk) === 'string')\n\t\tchunk = new Buffer(chunk, 'binary');\n\tthis.chunks.push(chunk);\n};\n\nSigner.prototype.sign = function () {\n\tvar sig = nacl.sign.detached(\n\t    new Uint8Array(Buffer.concat(this.chunks)),\n\t    new Uint8Array(this.key.part.r.data));\n\tvar sigBuf = new Buffer(sig);\n\tvar sigObj = Signature.parse(sigBuf, 'ed25519', 'raw');\n\tsigObj.hashAlgorithm = 'sha512';\n\treturn (sigObj);\n};\n"]}