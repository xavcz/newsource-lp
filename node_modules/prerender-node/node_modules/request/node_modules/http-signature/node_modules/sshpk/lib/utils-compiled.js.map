{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["// Copyright 2015 Joyent, Inc.\n\nmodule.exports = {\n\tbufferSplit: bufferSplit,\n\taddRSAMissing: addRSAMissing,\n\tcalculateDSAPublic: calculateDSAPublic,\n\tmpNormalize: mpNormalize,\n\tecNormalize: ecNormalize,\n\tcountZeros: countZeros,\n\tassertCompatible: assertCompatible,\n\tisCompatible: isCompatible\n};\n\nvar assert = require('assert-plus');\nvar PrivateKey = require('./private-key');\n\nvar MAX_CLASS_DEPTH = 3;\n\nfunction isCompatible(obj, klass, needVer) {\n\tif (obj === null || typeof (obj) !== 'object')\n\t\treturn (false);\n\tif (needVer === undefined)\n\t\tneedVer = klass.prototype._sshpkApiVersion;\n\tif (obj instanceof klass &&\n\t    klass.prototype._sshpkApiVersion[0] == needVer[0])\n\t\treturn (true);\n\tvar proto = Object.getPrototypeOf(obj);\n\tvar depth = 0;\n\twhile (proto.constructor.name !== klass.name) {\n\t\tproto = Object.getPrototypeOf(proto);\n\t\tif (!proto || ++depth > MAX_CLASS_DEPTH)\n\t\t\treturn (false);\n\t}\n\tif (proto.constructor.name !== klass.name)\n\t\treturn (false);\n\tvar ver = proto._sshpkApiVersion;\n\tif (ver === undefined)\n\t\tver = klass._oldVersionDetect(obj);\n\tif (ver[0] != needVer[0] || ver[1] < needVer[1])\n\t\treturn (false);\n\treturn (true);\n}\n\nfunction assertCompatible(obj, klass, needVer, name) {\n\tif (name === undefined)\n\t\tname = 'object';\n\tassert.ok(obj, name + ' must not be null');\n\tassert.object(obj, name + ' must be an object');\n\tif (needVer === undefined)\n\t\tneedVer = klass.prototype._sshpkApiVersion;\n\tif (obj instanceof klass &&\n\t    klass.prototype._sshpkApiVersion[0] == needVer[0])\n\t\treturn;\n\tvar proto = Object.getPrototypeOf(obj);\n\tvar depth = 0;\n\twhile (proto.constructor.name !== klass.name) {\n\t\tproto = Object.getPrototypeOf(proto);\n\t\tassert.ok(proto && ++depth <= MAX_CLASS_DEPTH,\n\t\t    name + ' must be a ' + klass.name + ' instance');\n\t}\n\tassert.strictEqual(proto.constructor.name, klass.name,\n\t    name + ' must be a ' + klass.name + ' instance');\n\tvar ver = proto._sshpkApiVersion;\n\tif (ver === undefined)\n\t\tver = klass._oldVersionDetect(obj);\n\tassert.ok(ver[0] == needVer[0] && ver[1] >= needVer[1],\n\t    name + ' must be compatible with ' + klass.name + ' klass ' +\n\t    'version ' + needVer[0] + '.' + needVer[1]);\n}\n\n/* Count leading zero bits on a buffer */\nfunction countZeros(buf) {\n\tvar o = 0, obit = 8;\n\twhile (o < buf.length) {\n\t\tvar mask = (1 << obit);\n\t\tif ((buf[o] & mask) === mask)\n\t\t\tbreak;\n\t\tobit--;\n\t\tif (obit < 0) {\n\t\t\to++;\n\t\t\tobit = 8;\n\t\t}\n\t}\n\treturn (o*8 + (8 - obit) - 1);\n}\n\nfunction bufferSplit(buf, chr) {\n\tassert.buffer(buf);\n\tassert.string(chr);\n\n\tvar parts = [];\n\tvar lastPart = 0;\n\tvar matches = 0;\n\tfor (var i = 0; i < buf.length; ++i) {\n\t\tif (buf[i] === chr.charCodeAt(matches))\n\t\t\t++matches;\n\t\telse if (buf[i] === chr.charCodeAt(0))\n\t\t\tmatches = 1;\n\t\telse\n\t\t\tmatches = 0;\n\n\t\tif (matches >= chr.length) {\n\t\t\tvar newPart = i + 1;\n\t\t\tparts.push(buf.slice(lastPart, newPart - matches));\n\t\t\tlastPart = newPart;\n\t\t\tmatches = 0;\n\t\t}\n\t}\n\tif (lastPart <= buf.length)\n\t\tparts.push(buf.slice(lastPart, buf.length));\n\n\treturn (parts);\n}\n\nfunction ecNormalize(buf, addZero) {\n\tassert.buffer(buf);\n\tif (buf[0] === 0x00 && buf[1] === 0x04) {\n\t\tif (addZero)\n\t\t\treturn (buf);\n\t\treturn (buf.slice(1));\n\t} else if (buf[0] === 0x04) {\n\t\tif (!addZero)\n\t\t\treturn (buf);\n\t} else {\n\t\twhile (buf[0] === 0x00)\n\t\t\tbuf = buf.slice(1);\n\t\tif (buf[0] === 0x02 || buf[0] === 0x03)\n\t\t\tthrow (new Error('Compressed elliptic curve points ' +\n\t\t\t    'are not supported'));\n\t\tif (buf[0] !== 0x04)\n\t\t\tthrow (new Error('Not a valid elliptic curve point'));\n\t\tif (!addZero)\n\t\t\treturn (buf);\n\t}\n\tvar b = new Buffer(buf.length + 1);\n\tb[0] = 0x0;\n\tbuf.copy(b, 1);\n\treturn (b);\n}\n\nfunction mpNormalize(buf) {\n\tassert.buffer(buf);\n\twhile (buf.length > 1 && buf[0] === 0x00 && (buf[1] & 0x80) === 0x00)\n\t\tbuf = buf.slice(1);\n\tif ((buf[0] & 0x80) === 0x80) {\n\t\tvar b = new Buffer(buf.length + 1);\n\t\tb[0] = 0x00;\n\t\tbuf.copy(b, 1);\n\t\tbuf = b;\n\t}\n\treturn (buf);\n}\n\nfunction bigintToMpBuf(bigint) {\n\tvar buf = new Buffer(bigint.toByteArray());\n\tbuf = mpNormalize(buf);\n\treturn (buf);\n}\n\nfunction calculateDSAPublic(g, p, x) {\n\tassert.buffer(g);\n\tassert.buffer(p);\n\tassert.buffer(x);\n\ttry {\n\t\tvar bigInt = require('jsbn').BigInteger;\n\t} catch (e) {\n\t\tthrow (new Error('To load a PKCS#8 format DSA private key, ' +\n\t\t    'the node jsbn library is required.'));\n\t}\n\tg = new bigInt(g);\n\tp = new bigInt(p);\n\tx = new bigInt(x);\n\tvar y = g.modPow(x, p);\n\tvar ybuf = bigintToMpBuf(y);\n\treturn (ybuf);\n}\n\nfunction addRSAMissing(key) {\n\tassert.object(key);\n\tassertCompatible(key, PrivateKey, [1, 1]);\n\ttry {\n\t\tvar bigInt = require('jsbn').BigInteger;\n\t} catch (e) {\n\t\tthrow (new Error('To write a PEM private key from ' +\n\t\t    'this source, the node jsbn lib is required.'));\n\t}\n\n\tvar d = new bigInt(key.part.d.data);\n\tvar buf;\n\n\tif (!key.part.dmodp) {\n\t\tvar p = new bigInt(key.part.p.data);\n\t\tvar dmodp = d.mod(p.subtract(1));\n\n\t\tbuf = bigintToMpBuf(dmodp);\n\t\tkey.part.dmodp = {name: 'dmodp', data: buf};\n\t\tkey.parts.push(key.part.dmodp);\n\t}\n\tif (!key.part.dmodq) {\n\t\tvar q = new bigInt(key.part.q.data);\n\t\tvar dmodq = d.mod(q.subtract(1));\n\n\t\tbuf = bigintToMpBuf(dmodq);\n\t\tkey.part.dmodq = {name: 'dmodq', data: buf};\n\t\tkey.parts.push(key.part.dmodq);\n\t}\n}\n"]}