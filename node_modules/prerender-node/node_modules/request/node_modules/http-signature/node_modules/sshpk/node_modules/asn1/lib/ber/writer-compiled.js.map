{"version":3,"sources":["writer.js"],"names":[],"mappings":"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","file":"writer-compiled.js","sourcesContent":["// Copyright 2011 Mark Cavage <mcavage@gmail.com> All rights reserved.\n\nvar assert = require('assert');\nvar ASN1 = require('./types');\nvar errors = require('./errors');\n\n\n///--- Globals\n\nvar newInvalidAsn1Error = errors.newInvalidAsn1Error;\n\nvar DEFAULT_OPTS = {\n  size: 1024,\n  growthFactor: 8\n};\n\n\n///--- Helpers\n\nfunction merge(from, to) {\n  assert.ok(from);\n  assert.equal(typeof(from), 'object');\n  assert.ok(to);\n  assert.equal(typeof(to), 'object');\n\n  var keys = Object.getOwnPropertyNames(from);\n  keys.forEach(function(key) {\n    if (to[key])\n      return;\n\n    var value = Object.getOwnPropertyDescriptor(from, key);\n    Object.defineProperty(to, key, value);\n  });\n\n  return to;\n}\n\n\n\n///--- API\n\nfunction Writer(options) {\n  options = merge(DEFAULT_OPTS, options || {});\n\n  this._buf = new Buffer(options.size || 1024);\n  this._size = this._buf.length;\n  this._offset = 0;\n  this._options = options;\n\n  // A list of offsets in the buffer where we need to insert\n  // sequence tag/len pairs.\n  this._seq = [];\n}\n\nObject.defineProperty(Writer.prototype, 'buffer', {\n  get: function () {\n    if (this._seq.length)\n      throw new InvalidAsn1Error(this._seq.length + ' unended sequence(s)');\n\n    return (this._buf.slice(0, this._offset));\n  }\n});\n\nWriter.prototype.writeByte = function(b) {\n  if (typeof(b) !== 'number')\n    throw new TypeError('argument must be a Number');\n\n  this._ensure(1);\n  this._buf[this._offset++] = b;\n};\n\n\nWriter.prototype.writeInt = function(i, tag) {\n  if (typeof(i) !== 'number')\n    throw new TypeError('argument must be a Number');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Integer;\n\n  var sz = 4;\n\n  while ((((i & 0xff800000) === 0) || ((i & 0xff800000) === 0xff800000 >> 0)) &&\n         (sz > 1)) {\n    sz--;\n    i <<= 8;\n  }\n\n  if (sz > 4)\n    throw new InvalidAsn1Error('BER ints cannot be > 0xffffffff');\n\n  this._ensure(2 + sz);\n  this._buf[this._offset++] = tag;\n  this._buf[this._offset++] = sz;\n\n  while (sz-- > 0) {\n    this._buf[this._offset++] = ((i & 0xff000000) >>> 24);\n    i <<= 8;\n  }\n\n};\n\n\nWriter.prototype.writeNull = function() {\n  this.writeByte(ASN1.Null);\n  this.writeByte(0x00);\n};\n\n\nWriter.prototype.writeEnumeration = function(i, tag) {\n  if (typeof(i) !== 'number')\n    throw new TypeError('argument must be a Number');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Enumeration;\n\n  return this.writeInt(i, tag);\n};\n\n\nWriter.prototype.writeBoolean = function(b, tag) {\n  if (typeof(b) !== 'boolean')\n    throw new TypeError('argument must be a Boolean');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Boolean;\n\n  this._ensure(3);\n  this._buf[this._offset++] = tag;\n  this._buf[this._offset++] = 0x01;\n  this._buf[this._offset++] = b ? 0xff : 0x00;\n};\n\n\nWriter.prototype.writeString = function(s, tag) {\n  if (typeof(s) !== 'string')\n    throw new TypeError('argument must be a string (was: ' + typeof(s) + ')');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.OctetString;\n\n  var len = Buffer.byteLength(s);\n  this.writeByte(tag);\n  this.writeLength(len);\n  if (len) {\n    this._ensure(len);\n    this._buf.write(s, this._offset);\n    this._offset += len;\n  }\n};\n\n\nWriter.prototype.writeBuffer = function(buf, tag) {\n  if (typeof(tag) !== 'number')\n    throw new TypeError('tag must be a number');\n  if (!Buffer.isBuffer(buf))\n    throw new TypeError('argument must be a buffer');\n\n  this.writeByte(tag);\n  this.writeLength(buf.length);\n  this._ensure(buf.length);\n  buf.copy(this._buf, this._offset, 0, buf.length);\n  this._offset += buf.length;\n};\n\n\nWriter.prototype.writeStringArray = function(strings) {\n  if ((!strings instanceof Array))\n    throw new TypeError('argument must be an Array[String]');\n\n  var self = this;\n  strings.forEach(function(s) {\n    self.writeString(s);\n  });\n};\n\n// This is really to solve DER cases, but whatever for now\nWriter.prototype.writeOID = function(s, tag) {\n  if (typeof(s) !== 'string')\n    throw new TypeError('argument must be a string');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.OID;\n\n  if (!/^([0-9]+\\.){3,}[0-9]+$/.test(s))\n    throw new Error('argument is not a valid OID string');\n\n  function encodeOctet(bytes, octet) {\n    if (octet < 128) {\n        bytes.push(octet);\n    } else if (octet < 16384) {\n        bytes.push((octet >>> 7) | 0x80);\n        bytes.push(octet & 0x7F);\n    } else if (octet < 2097152) {\n      bytes.push((octet >>> 14) | 0x80);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    } else if (octet < 268435456) {\n      bytes.push((octet >>> 21) | 0x80);\n      bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    } else {\n      bytes.push(((octet >>> 28) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 21) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    }\n  }\n\n  var tmp = s.split('.');\n  var bytes = [];\n  bytes.push(parseInt(tmp[0], 10) * 40 + parseInt(tmp[1], 10));\n  tmp.slice(2).forEach(function(b) {\n    encodeOctet(bytes, parseInt(b, 10));\n  });\n\n  var self = this;\n  this._ensure(2 + bytes.length);\n  this.writeByte(tag);\n  this.writeLength(bytes.length);\n  bytes.forEach(function(b) {\n    self.writeByte(b);\n  });\n};\n\n\nWriter.prototype.writeLength = function(len) {\n  if (typeof(len) !== 'number')\n    throw new TypeError('argument must be a Number');\n\n  this._ensure(4);\n\n  if (len <= 0x7f) {\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xff) {\n    this._buf[this._offset++] = 0x81;\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xffff) {\n    this._buf[this._offset++] = 0x82;\n    this._buf[this._offset++] = len >> 8;\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xffffff) {\n    this._buf[this._offset++] = 0x83;\n    this._buf[this._offset++] = len >> 16;\n    this._buf[this._offset++] = len >> 8;\n    this._buf[this._offset++] = len;\n  } else {\n    throw new InvalidAsn1ERror('Length too long (> 4 bytes)');\n  }\n};\n\nWriter.prototype.startSequence = function(tag) {\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Sequence | ASN1.Constructor;\n\n  this.writeByte(tag);\n  this._seq.push(this._offset);\n  this._ensure(3);\n  this._offset += 3;\n};\n\n\nWriter.prototype.endSequence = function() {\n  var seq = this._seq.pop();\n  var start = seq + 3;\n  var len = this._offset - start;\n\n  if (len <= 0x7f) {\n    this._shift(start, len, -2);\n    this._buf[seq] = len;\n  } else if (len <= 0xff) {\n    this._shift(start, len, -1);\n    this._buf[seq] = 0x81;\n    this._buf[seq + 1] = len;\n  } else if (len <= 0xffff) {\n    this._buf[seq] = 0x82;\n    this._buf[seq + 1] = len >> 8;\n    this._buf[seq + 2] = len;\n  } else if (len <= 0xffffff) {\n    this._shift(start, len, 1);\n    this._buf[seq] = 0x83;\n    this._buf[seq + 1] = len >> 16;\n    this._buf[seq + 2] = len >> 8;\n    this._buf[seq + 3] = len;\n  } else {\n    throw new InvalidAsn1Error('Sequence too long');\n  }\n};\n\n\nWriter.prototype._shift = function(start, len, shift) {\n  assert.ok(start !== undefined);\n  assert.ok(len !== undefined);\n  assert.ok(shift);\n\n  this._buf.copy(this._buf, start + shift, start, start + len);\n  this._offset += shift;\n};\n\nWriter.prototype._ensure = function(len) {\n  assert.ok(len);\n\n  if (this._size - this._offset < len) {\n    var sz = this._size * this._options.growthFactor;\n    if (sz - this._offset < len)\n      sz += len;\n\n    var buf = new Buffer(sz);\n\n    this._buf.copy(buf, 0, 0, this._offset);\n    this._buf = buf;\n    this._size = sz;\n  }\n};\n\n\n\n///--- Exported API\n\nmodule.exports = Writer;\n"]}