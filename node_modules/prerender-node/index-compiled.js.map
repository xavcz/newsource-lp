{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var request = require('request')\n  , url = require('url')\n  , zlib = require('zlib');\n\nvar prerender = module.exports = function(req, res, next) {\n  if(!prerender.shouldShowPrerenderedPage(req)) return next();\n\n  prerender.beforeRenderFn(req, function(err, cachedRender) {\n\n    if (!err && cachedRender) {\n      if (typeof cachedRender == 'string') {\n        res.writeHead(200, {\n          \"Content-Type\": \"text/html\"\n        });\n        return res.end(cachedRender);\n      } else if (typeof cachedRender == 'object') {\n        res.writeHead(cachedRender.status || 200, {\n          \"Content-Type\": \"text/html\"\n        });\n        return res.end(cachedRender.body || '');\n      }\n    }\n\n    prerender.getPrerenderedPageResponse(req, function(err, prerenderedResponse){\n      prerender.afterRenderFn(err, req, prerenderedResponse);\n\n      if(prerenderedResponse){\n        res.writeHead(prerenderedResponse.statusCode, prerenderedResponse.headers);\n        return res.end(prerenderedResponse.body);\n      } else {\n        next(err);\n      }\n    });\n  });\n};\n\n// googlebot, yahoo, and bingbot are not in this list because\n// we support _escaped_fragment_ and want to ensure people aren't\n// penalized for cloaking.\nprerender.crawlerUserAgents = [\n  // 'googlebot',\n  // 'yahoo',\n  // 'bingbot',\n  'baiduspider',\n  'facebookexternalhit',\n  'twitterbot',\n  'rogerbot',\n  'linkedinbot',\n  'embedly',\n  'quora link preview',\n  'showyoubot',\n  'outbrain',\n  'pinterest/0.',\n  'developers.google.com/+/web/snippet',\n  'slackbot',\n  'vkShare',\n  'W3C_Validator',\n  'redditbot',\n  'Applebot',\n  'WhatsApp',\n  'flipboard'\n];\n\n\nprerender.extensionsToIgnore = [\n  '.js',\n  '.css',\n  '.xml',\n  '.less',\n  '.png',\n  '.jpg',\n  '.jpeg',\n  '.gif',\n  '.pdf',\n  '.doc',\n  '.txt',\n  '.ico',\n  '.rss',\n  '.zip',\n  '.mp3',\n  '.rar',\n  '.exe',\n  '.wmv',\n  '.doc',\n  '.avi',\n  '.ppt',\n  '.mpg',\n  '.mpeg',\n  '.tif',\n  '.wav',\n  '.mov',\n  '.psd',\n  '.ai',\n  '.xls',\n  '.mp4',\n  '.m4a',\n  '.swf',\n  '.dat',\n  '.dmg',\n  '.iso',\n  '.flv',\n  '.m4v',\n  '.torrent',\n  '.woff',\n  '.ttf',\n  '.svg'\n];\n\n\nprerender.whitelisted = function(whitelist) {\n  prerender.whitelist = typeof whitelist === 'string' ? [whitelist] : whitelist;\n  return this;\n};\n\n\nprerender.blacklisted = function(blacklist) {\n  prerender.blacklist = typeof blacklist === 'string' ? [blacklist] : blacklist;\n  return this;\n};\n\n\nprerender.shouldShowPrerenderedPage = function(req) {\n  var userAgent = req.headers['user-agent']\n    , bufferAgent = req.headers['x-bufferbot']\n    , isRequestingPrerenderedPage = false;\n\n  if(!userAgent) return false;\n  if(req.method != 'GET' && req.method != 'HEAD') return false;\n\n  //if it contains _escaped_fragment_, show prerendered page\n  var parsedQuery = url.parse(req.url, true).query;\n  if(parsedQuery && parsedQuery.hasOwnProperty('_escaped_fragment_')) isRequestingPrerenderedPage = true;\n\n  //if it is a bot...show prerendered page\n  if(prerender.crawlerUserAgents.some(function(crawlerUserAgent){ return userAgent.toLowerCase().indexOf(crawlerUserAgent.toLowerCase()) !== -1;})) isRequestingPrerenderedPage = true;\n\n  //if it is BufferBot...show prerendered page\n  if(bufferAgent) isRequestingPrerenderedPage = true;\n\n  //if it is a bot and is requesting a resource...dont prerender\n  if(prerender.extensionsToIgnore.some(function(extension){return req.url.indexOf(extension) !== -1;})) return false;\n\n  //if it is a bot and not requesting a resource and is not whitelisted...dont prerender\n  if(Array.isArray(this.whitelist) && this.whitelist.every(function(whitelisted){return (new RegExp(whitelisted)).test(req.url) === false;})) return false;\n\n  //if it is a bot and not requesting a resource and is not blacklisted(url or referer)...dont prerender\n  if(Array.isArray(this.blacklist) && this.blacklist.some(function(blacklisted){\n    var blacklistedUrl = false\n      , blacklistedReferer = false\n      , regex = new RegExp(blacklisted);\n\n    blacklistedUrl = regex.test(req.url) === true;\n    if(req.headers['referer']) blacklistedReferer = regex.test(req.headers['referer']) === true;\n\n    return blacklistedUrl || blacklistedReferer;\n  })) return false;\n\n  return isRequestingPrerenderedPage;\n};\n\n\nprerender.getPrerenderedPageResponse = function(req, callback) {\n  var options = {\n    uri: url.parse(prerender.buildApiUrl(req)),\n    followRedirect: false,\n    headers: {}\n  };\n  if (this.forwardHeaders === true) {\n    Object.keys(req.headers).forEach(function(h) {\n      options.headers[h] = req.headers[h];\n    });\n  }\n  options.headers['User-Agent'] = req.headers['user-agent'];\n  options.headers['Accept-Encoding'] = 'gzip';\n  if(this.prerenderToken || process.env.PRERENDER_TOKEN) {\n    options.headers['X-Prerender-Token'] = this.prerenderToken || process.env.PRERENDER_TOKEN;\n  }\n\n  request.get(options).on('response', function(response) {\n    if(response.headers['content-encoding'] && response.headers['content-encoding'] === 'gzip') {\n      prerender.gunzipResponse(response, callback);\n    } else {\n      prerender.plainResponse(response, callback);\n    }\n  }).on('error', function(err) {\n    callback(err);\n  });\n};\n\nprerender.gunzipResponse = function(response, callback) {\n  var gunzip = zlib.createGunzip()\n    , content = '';\n\n  gunzip.on('data', function(chunk) {\n    content += chunk;\n  });\n  gunzip.on('end', function() {\n    response.body = content;\n    delete response.headers['content-encoding'];\n    delete response.headers['content-length'];\n    callback(null, response);\n  });\n  gunzip.on('error', function(err){\n    callback(err);\n  });\n\n  response.pipe(gunzip);\n};\n\nprerender.plainResponse = function(response, callback) {\n  var content = '';\n\n  response.on('data', function(chunk) {\n    content += chunk;\n  });\n  response.on('end', function() {\n    response.body = content;\n    callback(null, response);\n  });\n};\n\n\nprerender.buildApiUrl = function(req) {\n  var prerenderUrl = prerender.getPrerenderServiceUrl();\n  var forwardSlash = prerenderUrl.indexOf('/', prerenderUrl.length - 1) !== -1 ? '' : '/';\n\n  var protocol = req.connection.encrypted ? \"https\" : \"http\";\n  if (req.headers['cf-visitor']) {\n    var match = req.headers['cf-visitor'].match(/\"scheme\":\"(http|https)\"/);\n    if (match) protocol = match[1];\n  }\n  if (req.headers['x-forwarded-proto']) {\n    protocol = req.headers['x-forwarded-proto'].split(',')[0];\n  }\n  if (this.protocol) {\n    protocol = this.protocol;\n  }\n  var fullUrl = protocol + \"://\" + (this.host || req.headers['host']) + req.url;\n  return prerenderUrl + forwardSlash + fullUrl;\n};\n\nprerender.getPrerenderServiceUrl = function() {\n  return this.prerenderServiceUrl || process.env.PRERENDER_SERVICE_URL || 'http://service.prerender.io/';\n};\n\nprerender.beforeRenderFn = function(req, done) {\n  if (!this.beforeRender) return done();\n\n  return this.beforeRender(req, done);\n};\n\n\nprerender.afterRenderFn = function(err, req, prerender_res) {\n  if (!this.afterRender) return;\n\n  this.afterRender(err, req, prerender_res);\n};\n\n\nprerender.set = function(name, value) {\n  this[name] = value;\n  return this;\n};\n"]}