{"version":3,"sources":["der.js"],"names":[],"mappings":"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","file":"der-compiled.js","sourcesContent":["var inherits = require('inherits');\n\nvar asn1 = require('../../asn1');\nvar base = asn1.base;\nvar bignum = asn1.bignum;\n\n// Import DER constants\nvar der = asn1.constants.der;\n\nfunction DERDecoder(entity) {\n  this.enc = 'der';\n  this.name = entity.name;\n  this.entity = entity;\n\n  // Construct base tree\n  this.tree = new DERNode();\n  this.tree._init(entity.body);\n};\nmodule.exports = DERDecoder;\n\nDERDecoder.prototype.decode = function decode(data, options) {\n  if (!(data instanceof base.DecoderBuffer))\n    data = new base.DecoderBuffer(data, options);\n\n  return this.tree._decode(data, options);\n};\n\n// Tree methods\n\nfunction DERNode(parent) {\n  base.Node.call(this, 'der', parent);\n}\ninherits(DERNode, base.Node);\n\nDERNode.prototype._peekTag = function peekTag(buffer, tag, any) {\n  if (buffer.isEmpty())\n    return false;\n\n  var state = buffer.save();\n  var decodedTag = derDecodeTag(buffer, 'Failed to peek tag: \"' + tag + '\"');\n  if (buffer.isError(decodedTag))\n    return decodedTag;\n\n  buffer.restore(state);\n\n  return decodedTag.tag === tag || decodedTag.tagStr === tag || any;\n};\n\nDERNode.prototype._decodeTag = function decodeTag(buffer, tag, any) {\n  var decodedTag = derDecodeTag(buffer,\n                                'Failed to decode tag of \"' + tag + '\"');\n  if (buffer.isError(decodedTag))\n    return decodedTag;\n\n  var len = derDecodeLen(buffer,\n                         decodedTag.primitive,\n                         'Failed to get length of \"' + tag + '\"');\n\n  // Failure\n  if (buffer.isError(len))\n    return len;\n\n  if (!any &&\n      decodedTag.tag !== tag &&\n      decodedTag.tagStr !== tag &&\n      decodedTag.tagStr + 'of' !== tag) {\n    return buffer.error('Failed to match tag: \"' + tag + '\"');\n  }\n\n  if (decodedTag.primitive || len !== null)\n    return buffer.skip(len, 'Failed to match body of: \"' + tag + '\"');\n\n  // Indefinite length... find END tag\n  var state = buffer.save();\n  var res = this._skipUntilEnd(\n      buffer,\n      'Failed to skip indefinite length body: \"' + this.tag + '\"');\n  if (buffer.isError(res))\n    return res;\n\n  len = buffer.offset - state.offset;\n  buffer.restore(state);\n  return buffer.skip(len, 'Failed to match body of: \"' + tag + '\"');\n};\n\nDERNode.prototype._skipUntilEnd = function skipUntilEnd(buffer, fail) {\n  while (true) {\n    var tag = derDecodeTag(buffer, fail);\n    if (buffer.isError(tag))\n      return tag;\n    var len = derDecodeLen(buffer, tag.primitive, fail);\n    if (buffer.isError(len))\n      return len;\n\n    var res;\n    if (tag.primitive || len !== null)\n      res = buffer.skip(len)\n    else\n      res = this._skipUntilEnd(buffer, fail);\n\n    // Failure\n    if (buffer.isError(res))\n      return res;\n\n    if (tag.tagStr === 'end')\n      break;\n  }\n};\n\nDERNode.prototype._decodeList = function decodeList(buffer, tag, decoder) {\n  var result = [];\n  while (!buffer.isEmpty()) {\n    var possibleEnd = this._peekTag(buffer, 'end');\n    if (buffer.isError(possibleEnd))\n      return possibleEnd;\n\n    var res = decoder.decode(buffer, 'der');\n    if (buffer.isError(res) && possibleEnd)\n      break;\n    result.push(res);\n  }\n  return result;\n};\n\nDERNode.prototype._decodeStr = function decodeStr(buffer, tag) {\n  if (tag === 'bitstr') {\n    var unused = buffer.readUInt8();\n    if (buffer.isError(unused))\n      return unused;\n    return { unused: unused, data: buffer.raw() };\n  } else if (tag === 'bmpstr') {\n    var raw = buffer.raw();\n    if (raw.length % 2 === 1)\n      return buffer.error('Decoding of string type: bmpstr length mismatch');\n\n    var str = '';\n    for (var i = 0; i < raw.length / 2; i++) {\n      str += String.fromCharCode(raw.readUInt16BE(i * 2));\n    }\n    return str;\n  } else if (tag === 'numstr') {\n    var numstr = buffer.raw().toString('ascii');\n    if (!this._isNumstr(numstr)) {\n      return buffer.error('Decoding of string type: ' +\n                          'numstr unsupported characters');\n    }\n    return numstr;\n  } else if (tag === 'octstr') {\n    return buffer.raw();\n  } else if (tag === 'printstr') {\n    var printstr = buffer.raw().toString('ascii');\n    if (!this._isPrintstr(printstr)) {\n      return buffer.error('Decoding of string type: ' +\n                          'printstr unsupported characters');\n    }\n    return printstr;\n  } else if (/str$/.test(tag)) {\n    return buffer.raw().toString();\n  } else {\n    return buffer.error('Decoding of string type: ' + tag + ' unsupported');\n  }\n};\n\nDERNode.prototype._decodeObjid = function decodeObjid(buffer, values, relative) {\n  var result;\n  var identifiers = [];\n  var ident = 0;\n  while (!buffer.isEmpty()) {\n    var subident = buffer.readUInt8();\n    ident <<= 7;\n    ident |= subident & 0x7f;\n    if ((subident & 0x80) === 0) {\n      identifiers.push(ident);\n      ident = 0;\n    }\n  }\n  if (subident & 0x80)\n    identifiers.push(ident);\n\n  var first = (identifiers[0] / 40) | 0;\n  var second = identifiers[0] % 40;\n\n  if (relative)\n    result = identifiers;\n  else\n    result = [first, second].concat(identifiers.slice(1));\n\n  if (values) {\n    var tmp = values[result.join(' ')];\n    if (tmp === undefined)\n      tmp = values[result.join('.')];\n    if (tmp !== undefined)\n      result = tmp;\n  }\n\n  return result;\n};\n\nDERNode.prototype._decodeTime = function decodeTime(buffer, tag) {\n  var str = buffer.raw().toString();\n  if (tag === 'gentime') {\n    var year = str.slice(0, 4) | 0;\n    var mon = str.slice(4, 6) | 0;\n    var day = str.slice(6, 8) | 0;\n    var hour = str.slice(8, 10) | 0;\n    var min = str.slice(10, 12) | 0;\n    var sec = str.slice(12, 14) | 0;\n  } else if (tag === 'utctime') {\n    var year = str.slice(0, 2) | 0;\n    var mon = str.slice(2, 4) | 0;\n    var day = str.slice(4, 6) | 0;\n    var hour = str.slice(6, 8) | 0;\n    var min = str.slice(8, 10) | 0;\n    var sec = str.slice(10, 12) | 0;\n    if (year < 70)\n      year = 2000 + year;\n    else\n      year = 1900 + year;\n  } else {\n    return buffer.error('Decoding ' + tag + ' time is not supported yet');\n  }\n\n  return Date.UTC(year, mon - 1, day, hour, min, sec, 0);\n};\n\nDERNode.prototype._decodeNull = function decodeNull(buffer) {\n  return null;\n};\n\nDERNode.prototype._decodeBool = function decodeBool(buffer) {\n  var res = buffer.readUInt8();\n  if (buffer.isError(res))\n    return res;\n  else\n    return res !== 0;\n};\n\nDERNode.prototype._decodeInt = function decodeInt(buffer, values) {\n  // Bigint, return as it is (assume big endian)\n  var raw = buffer.raw();\n  var res = new bignum(raw);\n\n  if (values)\n    res = values[res.toString(10)] || res;\n\n  return res;\n};\n\nDERNode.prototype._use = function use(entity, obj) {\n  if (typeof entity === 'function')\n    entity = entity(obj);\n  return entity._getDecoder('der').tree;\n};\n\n// Utility methods\n\nfunction derDecodeTag(buf, fail) {\n  var tag = buf.readUInt8(fail);\n  if (buf.isError(tag))\n    return tag;\n\n  var cls = der.tagClass[tag >> 6];\n  var primitive = (tag & 0x20) === 0;\n\n  // Multi-octet tag - load\n  if ((tag & 0x1f) === 0x1f) {\n    var oct = tag;\n    tag = 0;\n    while ((oct & 0x80) === 0x80) {\n      oct = buf.readUInt8(fail);\n      if (buf.isError(oct))\n        return oct;\n\n      tag <<= 7;\n      tag |= oct & 0x7f;\n    }\n  } else {\n    tag &= 0x1f;\n  }\n  var tagStr = der.tag[tag];\n\n  return {\n    cls: cls,\n    primitive: primitive,\n    tag: tag,\n    tagStr: tagStr\n  };\n}\n\nfunction derDecodeLen(buf, primitive, fail) {\n  var len = buf.readUInt8(fail);\n  if (buf.isError(len))\n    return len;\n\n  // Indefinite form\n  if (!primitive && len === 0x80)\n    return null;\n\n  // Definite form\n  if ((len & 0x80) === 0) {\n    // Short form\n    return len;\n  }\n\n  // Long form\n  var num = len & 0x7f;\n  if (num >= 4)\n    return buf.error('length octect is too long');\n\n  len = 0;\n  for (var i = 0; i < num; i++) {\n    len <<= 8;\n    var j = buf.readUInt8(fail);\n    if (buf.isError(j))\n      return j;\n    len |= j;\n  }\n\n  return len;\n}\n"]}