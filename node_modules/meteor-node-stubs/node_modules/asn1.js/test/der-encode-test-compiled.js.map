{"version":3,"sources":["der-encode-test.js"],"names":[],"mappings":"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","file":"der-encode-test-compiled.js","sourcesContent":["var assert = require('assert');\nvar asn1 = require('..');\nvar BN = require('bn.js');\n\nvar Buffer = require('buffer').Buffer;\n\ndescribe('asn1.js DER encoder', function() {\n  /*\n   * Explicit value shold be wrapped with A0 | EXPLICIT tag\n   * this adds two more bytes to resulting buffer.\n   * */\n  it('should code explicit tag as 0xA2', function() {\n    var E = asn1.define('E', function() {\n      this.explicit(2).octstr()\n    });\n\n    var encoded = E.encode('X', 'der');\n\n    // <Explicit tag> <wrapped len> <str tag> <len> <payload>\n    assert.equal(encoded.toString('hex'), 'a203040158');\n    assert.equal(encoded.length, 5);\n  })\n\n  function test(name, model_definition, model_value, der_expected) {\n    it(name, function() {\n      var Model, der_actual;\n      Model = asn1.define('Model', model_definition);\n      der_actual = Model.encode(model_value, 'der');\n      assert.deepEqual(der_actual, new Buffer(der_expected,'hex'));\n    });\n  }\n\n  test('should encode choice', function() {\n    this.choice({\n      apple: this.bool(),\n    });\n  }, { type: 'apple', value: true }, '0101ff');\n\n  test('should encode implicit seqof', function() {\n    var Int = asn1.define('Int', function() {\n      this.int();\n    });\n    this.implicit(0).seqof(Int);\n  }, [ 1 ], 'A003020101' );\n\n  test('should encode explicit seqof', function() {\n    var Int = asn1.define('Int', function() {\n      this.int();\n    });\n    this.explicit(0).seqof(Int);\n  }, [ 1 ], 'A0053003020101' );\n\n  test('should encode BN(128) properly', function() {\n    this.int();\n  }, new BN(128), '02020080');\n\n  test('should encode int 128 properly', function() {\n    this.int();\n  }, 128, '02020080');\n\n  test('should encode 0x8011 properly', function() {\n    this.int();\n  }, 0x8011, '0203008011');\n\n  test('should omit default value in DER', function() {\n    this.seq().obj(\n      this.key('required').def(false).bool(),\n      this.key('value').int()\n    );\n  }, {required: false, value: 1}, '3003020101');\n\n  it('should encode optional and use', function() {\n    var B = asn1.define('B', function() {\n      this.int();\n    });\n\n    var A = asn1.define('A', function() {\n      this.optional().use(B);\n    });\n\n    var out = A.encode(1, 'der');\n    assert.equal(out.toString('hex'), '020101');\n  });\n\n  test('should properly encode objid with dots', function() {\n    this.objid({\n      '1.2.398.3.10.1.1.1.2.2': 'yes'\n    });\n  }, 'yes', '060a2a830e030a0101010202');\n\n  test('should properly encode objid as array of strings', function() {\n    this.objid();\n  }, '1.2.398.3.10.1.1.1.2.2'.split('.'), '060a2a830e030a0101010202');\n\n  test('should properly encode bmpstr', function() {\n    this.bmpstr();\n  }, 'CertificateTemplate', '1e26004300650072007400690066006900630061' +\n                            '0074006500540065006d0070006c006100740065');\n\n  test('should properly encode bmpstr with cyrillic chars', function() {\n    this.bmpstr();\n  }, 'Привет', '1e0c041f04400438043204350442');\n\n  it('should encode encapsulated models', function() {\n    var B = asn1.define('B', function() {\n      this.seq().obj(\n        this.key('nested').int()\n      );\n    });\n    var A = asn1.define('A', function() {\n      this.octstr().contains(B);\n    });\n\n    var out = A.encode({ nested: 5 }, 'der')\n    assert.equal(out.toString('hex'), '04053003020105');\n  });\n\n  test('should properly encode IA5 string', function() {\n    this.ia5str();\n  }, 'dog and bone', '160C646F6720616E6420626F6E65');\n\n  test('should properly encode printable string', function() {\n    this.printstr();\n  }, 'Brahms and Liszt', '1310427261686D7320616E64204C69737A74');\n\n  test('should properly encode T61 string', function() {\n    this.t61str();\n  }, 'Oliver Twist', '140C4F6C69766572205477697374');\n\n  test('should properly encode ISO646 string', function() {\n    this.iso646str();\n  }, 'septic tank', '1A0B7365707469632074616E6B');\n});\n"]}