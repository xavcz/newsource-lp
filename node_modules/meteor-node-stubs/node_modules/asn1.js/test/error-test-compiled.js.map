{"version":3,"sources":["error-test.js"],"names":[],"mappings":"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","file":"error-test-compiled.js","sourcesContent":["var assert = require('assert');\nvar asn1 = require('..');\nvar bn = asn1.bignum;\nvar fixtures = require('./fixtures');\nvar jsonEqual = fixtures.jsonEqual;\n\nvar Buffer = require('buffer').Buffer;\n\ndescribe('asn1.js error', function() {\n  describe('encoder', function() {\n    function test(name, model, input, expected) {\n      it('should support ' + name, function() {\n        var M = asn1.define('TestModel', model);\n\n        var error;\n        assert.throws(function() {\n          try {\n            var encoded = M.encode(input, 'der');\n          } catch (e) {\n            error = e;\n            throw e;\n          }\n        });\n\n        assert(expected.test(error.stack),\n               'Failed to match, expected: ' + expected + ' got: ' +\n                   JSON.stringify(error.stack));\n      });\n    }\n\n    describe('primitives', function() {\n      test('int', function() {\n        this.int();\n      }, 'hello', /no values map/i);\n\n      test('enum', function() {\n        this.enum({ 0: 'hello', 1: 'world' });\n      }, 'gosh', /contain: \"gosh\"/);\n\n      test('objid', function() {\n        this.objid();\n      }, 1, /objid\\(\\) should be either array or string, got: 1/);\n\n      test('numstr', function() {\n        this.numstr();\n      }, 'hello', /only digits and space/);\n\n      test('printstr', function() {\n        this.printstr();\n      }, 'hello!', /only latin upper and lower case letters/);\n    });\n\n    describe('composite', function() {\n      test('shallow', function() {\n        this.seq().obj(\n          this.key('key').int()\n        );\n      }, { key: 'hello' } , /map at: \\[\"key\"\\]/i);\n\n      test('deep and empty', function() {\n        this.seq().obj(\n          this.key('a').seq().obj(\n            this.key('b').seq().obj(\n              this.key('c').int()\n            )\n          )\n        );\n      }, { } , /input is not object at: \\[\"a\"\\]\\[\"b\"\\]/i);\n\n      test('deep', function() {\n        this.seq().obj(\n          this.key('a').seq().obj(\n            this.key('b').seq().obj(\n              this.key('c').int()\n            )\n          )\n        );\n      }, { a: { b: { c: 'hello' } } } , /map at: \\[\"a\"\\]\\[\"b\"\\]\\[\"c\"\\]/i);\n\n      test('use', function() {\n        var S = asn1.define('S', function() {\n          this.seq().obj(\n            this.key('x').int()\n          );\n        });\n\n        this.seq().obj(\n          this.key('a').seq().obj(\n            this.key('b').use(S)\n          )\n        );\n      }, { a: { b: { x: 'hello' } } } , /map at: \\[\"a\"\\]\\[\"b\"\\]\\[\"x\"\\]/i);\n    });\n  });\n\n  describe('decoder', function() {\n    function test(name, model, input, expected) {\n      it('should support ' + name, function() {\n        var M = asn1.define('TestModel', model);\n\n        var error;\n        assert.throws(function() {\n          try {\n            var decoded = M.decode(new Buffer(input, 'hex'), 'der');\n          } catch (e) {\n            error = e;\n            throw e;\n          }\n        });\n        var partial = M.decode(new Buffer(input, 'hex'), 'der', {\n          partial: true\n        });\n\n        assert(expected.test(error.stack),\n               'Failed to match, expected: ' + expected + ' got: ' +\n                   JSON.stringify(error.stack));\n\n        assert.equal(partial.errors.length, 1);\n        assert(expected.test(partial.errors[0].stack),\n               'Failed to match, expected: ' + expected + ' got: ' +\n                   JSON.stringify(partial.errors[0].stack));\n      });\n    }\n\n    describe('primitive', function() {\n      test('int', function() {\n        this.int();\n      }, '2201', /body of: \"int\"/);\n\n      test('int', function() {\n        this.int();\n      }, '', /tag of \"int\"/);\n\n      test('bmpstr invalid length', function() {\n        this.bmpstr();\n      }, '1e0b041f04400438043204350442', /bmpstr length mismatch/);\n\n      test('numstr unsupported characters', function() {\n        this.numstr();\n      }, '12024141', /numstr unsupported characters/);\n\n      test('printstr unsupported characters', function() {\n        this.printstr();\n      }, '13024121', /printstr unsupported characters/);\n    });\n\n    describe('composite', function() {\n      test('shallow', function() {\n        this.seq().obj(\n          this.key('a').seq().obj()\n        );\n      }, '30', /length of \"seq\"/);\n\n      test('deep and empty', function() {\n        this.seq().obj(\n          this.key('a').seq().obj(\n            this.key('b').seq().obj(\n              this.key('c').int()\n            )\n          )\n        );\n      }, '300430023000', /tag of \"int\" at: \\[\"a\"\\]\\[\"b\"\\]\\[\"c\"\\]/);\n\n      test('deep and incomplete', function() {\n        this.seq().obj(\n          this.key('a').seq().obj(\n            this.key('b').seq().obj(\n              this.key('c').int()\n            )\n          )\n        );\n      }, '30053003300122', /length of \"int\" at: \\[\"a\"\\]\\[\"b\"\\]\\[\"c\"\\]/);\n    });\n  });\n\n  describe('partial decoder', function() {\n    function test(name, model, input, expectedObj, expectedErrs) {\n      it('should support ' + name, function() {\n        var M = asn1.define('TestModel', model);\n\n        var decoded = M.decode(new Buffer(input, 'hex'), 'der', {\n          partial: true\n        });\n\n        jsonEqual(decoded.result, expectedObj);\n\n        assert.equal(decoded.errors.length, expectedErrs.length);\n        expectedErrs.forEach(function(expected, i) {\n          assert(expected.test(decoded.errors[i].stack),\n                 'Failed to match, expected: ' + expected + ' got: ' +\n                     JSON.stringify(decoded.errors[i].stack));\n        });\n      });\n    }\n\n    test('last key not present', function() {\n      this.seq().obj(\n        this.key('a').seq().obj(\n          this.key('b').seq().obj(\n            this.key('c').int()\n          ),\n          this.key('d').int()\n        )\n      );\n    }, '30073005300022012e', { a: { b: {}, d: new bn(46) } }, [\n      /\"int\" at: \\[\"a\"\\]\\[\"b\"\\]\\[\"c\"\\]/\n    ]);\n\n    test('first key not present', function() {\n      this.seq().obj(\n        this.key('a').seq().obj(\n          this.key('b').seq().obj(\n            this.key('c').int()\n          ),\n          this.key('d').int()\n        )\n      );\n    }, '30073005300322012e', { a: { b: { c: new bn(46) } } }, [\n      /\"int\" at: \\[\"a\"\\]\\[\"d\"\\]/\n    ]);\n  });\n});\n"]}