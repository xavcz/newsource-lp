{"version":3,"sources":["der-decode-test.js"],"names":[],"mappings":"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","file":"der-decode-test-compiled.js","sourcesContent":["var assert = require('assert');\nvar asn1 = require('..');\n\nvar Buffer = require('buffer').Buffer;\n\ndescribe('asn1.js DER decoder', function() {\n  it('should propagate implicit tag', function() {\n    var B = asn1.define('B', function() {\n      this.seq().obj(\n        this.key('b').octstr()\n      );\n    });\n\n    var A = asn1.define('Bug', function() {\n      this.seq().obj(\n        this.key('a').implicit(0).use(B)\n      );\n    });\n\n    var out = A.decode(new Buffer('300720050403313233', 'hex'), 'der');\n    assert.equal(out.a.b.toString(), '123');\n  });\n\n  it('should decode optional tag to undefined key', function() {\n    var A = asn1.define('A', function() {\n      this.seq().obj(\n        this.key('key').bool(),\n        this.optional().key('opt').bool()\n      );\n    });\n    var out = A.decode(new Buffer('30030101ff', 'hex'), 'der');\n    assert.deepEqual(out, { 'key': true });\n  });\n\n  it('should decode optional tag to default value', function() {\n    var A = asn1.define('A', function() {\n      this.seq().obj(\n        this.key('key').bool(),\n        this.optional().key('opt').octstr().def('default')\n      );\n    });\n    var out = A.decode(new Buffer('30030101ff', 'hex'), 'der');\n    assert.deepEqual(out, { 'key': true, 'opt': 'default' });\n  });\n\n  function test(name, model, inputHex, expected) {\n    it(name, function() {\n      var M = asn1.define('Model', model);\n      var decoded = M.decode(new Buffer(inputHex,'hex'), 'der');\n      assert.deepEqual(decoded, expected);\n    });\n  }\n\n  test('should decode choice', function() {\n    this.choice({\n      apple: this.bool(),\n    });\n  }, '0101ff', { 'type': 'apple', 'value': true });\n\n  it('should decode optional and use', function() {\n    var B = asn1.define('B', function() {\n      this.int();\n    });\n\n    var A = asn1.define('A', function() {\n      this.optional().use(B);\n    });\n\n    var out = A.decode(new Buffer('020101', 'hex'), 'der');\n    assert.equal(out.toString(10), '1');\n  });\n\n  test('should decode indefinite length', function() {\n    this.seq().obj(\n      this.key('key').bool()\n    );\n  }, '30800101ff0000', { 'key': true });\n\n  test('should decode bmpstr', function() {\n    this.bmpstr();\n  }, '1e26004300650072007400690066006900630061' +\n     '0074006500540065006d0070006c006100740065', 'CertificateTemplate');\n\n  test('should decode bmpstr with cyrillic chars', function() {\n    this.bmpstr();\n  }, '1e0c041f04400438043204350442', 'Привет');\n\n  test('should properly decode objid with dots', function() {\n    this.objid({\n      '1.2.398.3.10.1.1.1.2.2': 'yes'\n    });\n  }, '060a2a830e030a0101010202', 'yes');\n\n  it('should decode encapsulated models', function() {\n    var B = asn1.define('B', function() {\n      this.seq().obj(\n        this.key('nested').int()\n      );\n    });\n    var A = asn1.define('A', function() {\n      this.octstr().contains(B);\n    });\n\n    var out = A.decode(new Buffer('04053003020105', 'hex'), 'der');\n    assert.equal(out.nested.toString(10), '5');\n  });\n\n  test('should decode IA5 string', function() {\n    this.ia5str();\n  }, '160C646F6720616E6420626F6E65', 'dog and bone');\n\n  test('should decode printable string', function() {\n    this.printstr();\n  }, '1310427261686D7320616E64204C69737A74', 'Brahms and Liszt');\n\n  test('should decode T61 string', function() {\n    this.t61str();\n  }, '140C4F6C69766572205477697374', 'Oliver Twist');\n\n  test('should decode ISO646 string', function() {\n    this.iso646str();\n  }, '1A0B7365707469632074616E6B', 'septic tank');\n});\n"]}