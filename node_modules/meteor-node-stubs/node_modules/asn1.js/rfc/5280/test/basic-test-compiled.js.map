{"version":3,"sources":["basic-test.js"],"names":[],"mappings":"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","file":"basic-test-compiled.js","sourcesContent":["var assert = require('assert');\nvar fs = require('fs');\nvar asn1 = require('../../../');\nvar rfc5280 = require('..');\n\nvar Buffer = require('buffer').Buffer;\n\ndescribe('asn1.js RFC5280', function() {\n\n  it('should decode Certificate', function() {\n    var data = fs.readFileSync(__dirname + '/fixtures/cert1.crt');\n    var res = rfc5280.Certificate.decode(data, 'der');\n\n    var tbs = res.tbsCertificate;\n    assert.equal(tbs.version, 'v3');\n    assert.deepEqual(tbs.serialNumber,\n                     new asn1.bignum('462e4256bb1194dc', 16));\n    assert.equal(tbs.signature.algorithm.join('.'),\n                 '1.2.840.113549.1.1.5');\n    assert.equal(tbs.signature.parameters.toString('hex'), '0500');\n  });\n\n  it('should decode ECC Certificate', function() {\n    // Symantec Class 3 ECC 256 bit Extended Validation CA from\n    // https://knowledge.symantec.com/support/ssl-certificates-support/index?page=content&actp=CROSSLINK&id=AR1908\n    var data = fs.readFileSync(__dirname + '/fixtures/cert2.crt');\n    var res = rfc5280.Certificate.decode(data, 'der');\n\n    var tbs = res.tbsCertificate;\n    assert.equal(tbs.version, 'v3');\n    assert.deepEqual(tbs.serialNumber,\n                     new asn1.bignum('4d955d20af85c49f6925fbab7c665f89', 16));\n    assert.equal(tbs.signature.algorithm.join('.'),\n                 '1.2.840.10045.4.3.3');  // RFC5754\n    var spki = rfc5280.SubjectPublicKeyInfo.encode(tbs.subjectPublicKeyInfo,\n                                                   'der');\n// spki check to the output of\n// openssl x509 -in ecc_cert.pem -pubkey -noout |\n// openssl pkey -pubin  -outform der | openssl base64\n    assert.equal(spki.toString('base64'),\n                 'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE3QQ9svKQk5fG6bu8kdtR8KO' +\n                 'G7fvG04WTMgVJ4ASDYZZR/1chrgvaDucEoX/bKhy9ypg1xXFzQM3oaqtUhE' +\n                 'Mm4g=='\n                );\n  });\n\n  it('should decode AuthorityInfoAccess', function() {\n    var data = new Buffer('305a302b06082b06010505073002861f687474703a2f2f70' +\n                          '6b692e676f6f676c652e636f6d2f47494147322e63727430' +\n                          '2b06082b06010505073001861f687474703a2f2f636c6965' +\n                          '6e7473312e676f6f676c652e636f6d2f6f637370',\n                          'hex');\n\n    var info = rfc5280.AuthorityInfoAccessSyntax.decode(data, 'der');\n\n    assert(info[0].accessMethod);\n  });\n\n  it('should decode directoryName in GeneralName', function() {\n    var data = new Buffer('a411300f310d300b06022a03160568656c6c6f', 'hex');\n\n    var name = rfc5280.GeneralName.decode(data, 'der');\n    assert.equal(name.type, 'directoryName');\n  });\n\n  it('should decode Certificate Extensions', function() {\n    var data;\n    var cert;\n\n    var extensions = {}\n    data = fs.readFileSync(__dirname + '/fixtures/cert3.crt');\n    cert = rfc5280.Certificate.decode(data, 'der');\n    cert.tbsCertificate.extensions.forEach(function(e) {\n      extensions[e.extnID] = e\n    });\n    assert.equal(extensions.basicConstraints.extnValue.cA, false);\n    assert.equal(extensions.extendedKeyUsage.extnValue.length, 2);\n\n    extensions = {}\n    data = fs.readFileSync(__dirname + '/fixtures/cert4.crt');\n    cert = rfc5280.Certificate.decode(data, 'der');\n    cert.tbsCertificate.extensions.forEach(function(e) {\n      extensions[e.extnID] = e\n    });\n    assert.equal(extensions.basicConstraints.extnValue.cA, true);\n    assert.equal(extensions.authorityInformationAccess.extnValue[0]\n                 .accessLocation.value, 'http://ocsp.godaddy.com/')\n\n    extensions = {}\n    data = fs.readFileSync(__dirname + '/fixtures/cert5.crt');\n    cert = rfc5280.Certificate.decode(data, 'der');\n    cert.tbsCertificate.extensions.forEach(function(e) {\n      extensions[e.extnID] = e\n    });\n    assert.equal(extensions.basicConstraints.extnValue.cA, true);\n\n    extensions = {}\n    data = fs.readFileSync(__dirname + '/fixtures/cert6.crt');\n    cert = rfc5280.Certificate.decode(data, 'der');\n    cert.tbsCertificate.extensions.forEach(function(e) {\n      extensions[e.extnID] = e\n    });\n    assert.equal(extensions.basicConstraints.extnValue.cA, true);\n  });\n});\n"]}