{"version":3,"sources":["encrypter.js"],"names":[],"mappings":";;AAAA,IAAI,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,CAAA;AAC1B,IAAI,SAAS,GAAG,OAAO,CAAC,aAAa,CAAC,CAAA;AACtC,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAA;AAClC,IAAI,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC,CAAA;AAC9B,IAAI,IAAI,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAA;AACpC,IAAI,YAAY,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAA;AAC5C,IAAI,UAAU,GAAG,OAAO,CAAC,cAAc,CAAC,CAAA;AACxC,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC,CAAA;AAC3B,SAAS,MAAM,CAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE;AAC9B,MAAI,EAAE,IAAI,YAAY,MAAM,CAAA,AAAC,EAAE;AAC7B,WAAO,IAAI,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,CAAA;GACjC;AACD,WAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;AACpB,MAAI,CAAC,MAAM,GAAG,IAAI,QAAQ,EAAE,CAAA;AAC5B,MAAI,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;AAC/B,MAAI,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,CAAA;AAClC,IAAE,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;AACnB,MAAI,CAAC,KAAK,GAAG,IAAI,CAAA;AACjB,MAAI,CAAC,YAAY,GAAG,IAAI,CAAA;CACzB;AACD,MAAM,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,IAAI,EAAE;AACzC,MAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;AACrB,MAAI,KAAK,CAAA;AACT,MAAI,KAAK,CAAA;AACT,MAAI,GAAG,GAAG,EAAE,CAAA;AACZ,SAAQ,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,EAAG;AAClC,SAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;AACvC,OAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;GAChB;AACD,SAAO,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;CAC1B,CAAA;AACD,MAAM,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;AACpC,MAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAA;AAC/B,MAAI,IAAI,CAAC,YAAY,EAAE;AACrB,SAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;AACvC,QAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAA;AACpB,WAAO,KAAK,CAAA;GACb,MAAM,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,kCAAkC,EAAE;AACvE,QAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAA;AACpB,UAAM,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAA;GACrD;CACF,CAAA;AACD,MAAM,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,KAAK,EAAE;AACjD,MAAI,CAAC,YAAY,GAAG,CAAC,CAAC,KAAK,CAAA;AAC3B,SAAO,IAAI,CAAA;CACZ,CAAA;;AAED,SAAS,QAAQ,GAAI;AACnB,MAAI,EAAE,IAAI,YAAY,QAAQ,CAAA,AAAC,EAAE;AAC/B,WAAO,IAAI,QAAQ,EAAE,CAAA;GACtB;AACD,MAAI,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,EAAE,CAAC,CAAA;CAC5B;AACD,QAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,IAAI,EAAE;AACvC,MAAI,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAA;CAC/C,CAAA;;AAED,QAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,YAAY;AACnC,MAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,EAAE;AAC1B,QAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAA;AACjC,QAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,CAAA;AACjC,WAAO,GAAG,CAAA;GACX;AACD,SAAO,IAAI,CAAA;CACZ,CAAA;AACD,QAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;AACrC,MAAI,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAA;AAChC,MAAI,OAAO,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC,CAAA;;AAE7B,MAAI,CAAC,GAAG,CAAC,CAAC,CAAA;AACV,SAAO,EAAE,CAAC,GAAG,GAAG,EAAE;AAChB,WAAO,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,CAAA;GAC3B;AACD,MAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAA;AAC9C,SAAO,GAAG,CAAA;CACX,CAAA;AACD,IAAI,QAAQ,GAAG;AACb,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;AAC3B,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;AAC3B,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;AAC3B,MAAI,EAAE,OAAO,CAAC,cAAc,CAAC;AAC7B,MAAI,EAAE,OAAO,CAAC,cAAc,CAAC;AAC7B,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;AAC3B,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;AAC3B,KAAG,EAAE,OAAO,CAAC,aAAa,CAAC;CAC5B,CAAA;;AAED,SAAS,cAAc,CAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,EAAE;AAC5C,MAAI,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAA;AACvC,MAAI,CAAC,MAAM,EAAE;AACX,UAAM,IAAI,SAAS,CAAC,oBAAoB,CAAC,CAAA;GAC1C;AACD,MAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;AAC1B,MAAE,GAAG,IAAI,MAAM,CAAC,EAAE,CAAC,CAAA;GACpB;AACD,MAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;AAChC,YAAQ,GAAG,IAAI,MAAM,CAAC,QAAQ,CAAC,CAAA;GAChC;AACD,MAAI,QAAQ,CAAC,MAAM,KAAK,MAAM,CAAC,GAAG,GAAG,CAAC,EAAE;AACtC,UAAM,IAAI,SAAS,CAAC,qBAAqB,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAA;GAC7D;AACD,MAAI,EAAE,CAAC,MAAM,KAAK,MAAM,CAAC,EAAE,EAAE;AAC3B,UAAM,IAAI,SAAS,CAAC,oBAAoB,GAAG,EAAE,CAAC,MAAM,CAAC,CAAA;GACtD;AACD,MAAI,MAAM,CAAC,IAAI,KAAK,QAAQ,EAAE;AAC5B,WAAO,IAAI,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAA;GAC7D,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,EAAE;AACjC,WAAO,IAAI,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAA;GAC3D;AACD,SAAO,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAA;CACvD;AACD,SAAS,YAAY,CAAE,KAAK,EAAE,QAAQ,EAAE;AACtC,MAAI,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAA;AACvC,MAAI,CAAC,MAAM,EAAE;AACX,UAAM,IAAI,SAAS,CAAC,oBAAoB,CAAC,CAAA;GAC1C;AACD,MAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,CAAC,CAAA;AACvD,SAAO,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE,CAAC,CAAA;CAChD;;AAED,OAAO,CAAC,cAAc,GAAG,cAAc,CAAA;AACvC,OAAO,CAAC,YAAY,GAAG,YAAY,CAAA","file":"encrypter-compiled.js","sourcesContent":["var aes = require('./aes')\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar modes = require('./modes')\nvar ebtk = require('evp_bytestokey')\nvar StreamCipher = require('./streamCipher')\nvar AuthCipher = require('./authCipher')\ninherits(Cipher, Transform)\nfunction Cipher (mode, key, iv) {\n  if (!(this instanceof Cipher)) {\n    return new Cipher(mode, key, iv)\n  }\n  Transform.call(this)\n  this._cache = new Splitter()\n  this._cipher = new aes.AES(key)\n  this._prev = new Buffer(iv.length)\n  iv.copy(this._prev)\n  this._mode = mode\n  this._autopadding = true\n}\nCipher.prototype._update = function (data) {\n  this._cache.add(data)\n  var chunk\n  var thing\n  var out = []\n  while ((chunk = this._cache.get())) {\n    thing = this._mode.encrypt(this, chunk)\n    out.push(thing)\n  }\n  return Buffer.concat(out)\n}\nCipher.prototype._final = function () {\n  var chunk = this._cache.flush()\n  if (this._autopadding) {\n    chunk = this._mode.encrypt(this, chunk)\n    this._cipher.scrub()\n    return chunk\n  } else if (chunk.toString('hex') !== '10101010101010101010101010101010') {\n    this._cipher.scrub()\n    throw new Error('data not multiple of block length')\n  }\n}\nCipher.prototype.setAutoPadding = function (setTo) {\n  this._autopadding = !!setTo\n  return this\n}\n\nfunction Splitter () {\n  if (!(this instanceof Splitter)) {\n    return new Splitter()\n  }\n  this.cache = new Buffer('')\n}\nSplitter.prototype.add = function (data) {\n  this.cache = Buffer.concat([this.cache, data])\n}\n\nSplitter.prototype.get = function () {\n  if (this.cache.length > 15) {\n    var out = this.cache.slice(0, 16)\n    this.cache = this.cache.slice(16)\n    return out\n  }\n  return null\n}\nSplitter.prototype.flush = function () {\n  var len = 16 - this.cache.length\n  var padBuff = new Buffer(len)\n\n  var i = -1\n  while (++i < len) {\n    padBuff.writeUInt8(len, i)\n  }\n  var out = Buffer.concat([this.cache, padBuff])\n  return out\n}\nvar modelist = {\n  ECB: require('./modes/ecb'),\n  CBC: require('./modes/cbc'),\n  CFB: require('./modes/cfb'),\n  CFB8: require('./modes/cfb8'),\n  CFB1: require('./modes/cfb1'),\n  OFB: require('./modes/ofb'),\n  CTR: require('./modes/ctr'),\n  GCM: require('./modes/ctr')\n}\n\nfunction createCipheriv (suite, password, iv) {\n  var config = modes[suite.toLowerCase()]\n  if (!config) {\n    throw new TypeError('invalid suite type')\n  }\n  if (typeof iv === 'string') {\n    iv = new Buffer(iv)\n  }\n  if (typeof password === 'string') {\n    password = new Buffer(password)\n  }\n  if (password.length !== config.key / 8) {\n    throw new TypeError('invalid key length ' + password.length)\n  }\n  if (iv.length !== config.iv) {\n    throw new TypeError('invalid iv length ' + iv.length)\n  }\n  if (config.type === 'stream') {\n    return new StreamCipher(modelist[config.mode], password, iv)\n  } else if (config.type === 'auth') {\n    return new AuthCipher(modelist[config.mode], password, iv)\n  }\n  return new Cipher(modelist[config.mode], password, iv)\n}\nfunction createCipher (suite, password) {\n  var config = modes[suite.toLowerCase()]\n  if (!config) {\n    throw new TypeError('invalid suite type')\n  }\n  var keys = ebtk(password, false, config.key, config.iv)\n  return createCipheriv(suite, keys.key, keys.iv)\n}\n\nexports.createCipheriv = createCipheriv\nexports.createCipher = createCipher\n"]}