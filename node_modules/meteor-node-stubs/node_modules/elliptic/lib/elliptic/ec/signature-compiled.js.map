{"version":3,"sources":["signature.js"],"names":[],"mappings":"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","file":"signature-compiled.js","sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\n\nvar elliptic = require('../../elliptic');\nvar utils = elliptic.utils;\nvar assert = utils.assert;\n\nfunction Signature(options, enc) {\n  if (options instanceof Signature)\n    return options;\n\n  if (this._importDER(options, enc))\n    return;\n\n  assert(options.r && options.s, 'Signature without r or s');\n  this.r = new BN(options.r, 16);\n  this.s = new BN(options.s, 16);\n  if (options.recoveryParam === undefined)\n    this.recoveryParam = null;\n  else\n    this.recoveryParam = options.recoveryParam;\n}\nmodule.exports = Signature;\n\nfunction Position() {\n  this.place = 0;\n}\n\nfunction getLength(buf, p) {\n  var initial = buf[p.place++];\n  if (!(initial & 0x80)) {\n    return initial;\n  }\n  var octetLen = initial & 0xf;\n  var val = 0;\n  for (var i = 0, off = p.place; i < octetLen; i++, off++) {\n    val <<= 8;\n    val |= buf[off];\n  }\n  p.place = off;\n  return val;\n}\n\nfunction rmPadding(buf) {\n  var i = 0;\n  var len = buf.length - 1;\n  while (!buf[i] && !(buf[i + 1] & 0x80) && i < len) {\n    i++;\n  }\n  if (i === 0) {\n    return buf;\n  }\n  return buf.slice(i);\n}\n\nSignature.prototype._importDER = function _importDER(data, enc) {\n  data = utils.toArray(data, enc);\n  var p = new Position();\n  if (data[p.place++] !== 0x30) {\n    return false;\n  }\n  var len = getLength(data, p);\n  if ((len + p.place) !== data.length) {\n    return false;\n  }\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var rlen = getLength(data, p);\n  var r = data.slice(p.place, rlen + p.place);\n  p.place += rlen;\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var slen = getLength(data, p);\n  if (data.length !== slen + p.place) {\n    return false;\n  }\n  var s = data.slice(p.place, slen + p.place);\n  if (r[0] === 0 && (r[1] & 0x80)) {\n    r = r.slice(1);\n  }\n  if (s[0] === 0 && (s[1] & 0x80)) {\n    s = s.slice(1);\n  }\n\n  this.r = new BN(r);\n  this.s = new BN(s);\n  this.recoveryParam = null;\n\n  return true;\n};\n\nfunction constructLength(arr, len) {\n  if (len < 0x80) {\n    arr.push(len);\n    return;\n  }\n  var octets = 1 + (Math.log(len) / Math.LN2 >>> 3);\n  arr.push(octets | 0x80);\n  while (--octets) {\n    arr.push((len >>> (octets << 3)) & 0xff);\n  }\n  arr.push(len);\n}\n\nSignature.prototype.toDER = function toDER(enc) {\n  var r = this.r.toArray();\n  var s = this.s.toArray();\n\n  // Pad values\n  if (r[0] & 0x80)\n    r = [ 0 ].concat(r);\n  // Pad values\n  if (s[0] & 0x80)\n    s = [ 0 ].concat(s);\n\n  r = rmPadding(r);\n  s = rmPadding(s);\n\n  while (!s[0] && !(s[1] & 0x80)) {\n    s = s.slice(1);\n  }\n  var arr = [ 0x02 ];\n  constructLength(arr, r.length);\n  arr = arr.concat(r);\n  arr.push(0x02);\n  constructLength(arr, s.length);\n  var backHalf = arr.concat(s);\n  var res = [ 0x30 ];\n  constructLength(res, backHalf.length);\n  res = res.concat(backHalf);\n  return utils.encode(res, enc);\n};\n"]}