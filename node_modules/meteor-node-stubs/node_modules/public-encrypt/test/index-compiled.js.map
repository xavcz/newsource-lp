{"version":3,"sources":["index.js"],"names":[],"mappings":";;AAAA,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACrC,IAAI,SAAS,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACtC,OAAO,CAAC,aAAa,CAAC,CAAC;AACvB,IAAI,QAAQ,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC,CAAC;AAC7D,IAAI,OAAO,GAAG;AACZ,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;AACtD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,eAAe,CAAC;CACrD,CAAC;AACF,IAAI,WAAW,GAAG;AAChB,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;AACtD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;CACtD,CAAC;AACF,IAAI,OAAO,GAAG;AACZ,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;AACtD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,eAAe,CAAC;CACrD,CAAC;AACF,IAAI,OAAO,GAAG;AACZ,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;AACtD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,eAAe,CAAC;CACrD,CAAC;AACF,IAAI,UAAU,GAAG;AACf,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,YAAY,CAAC;AAClD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,WAAW,CAAC;CACjD,CAAC;AACF,IAAI,aAAa,GAAG;AAClB,aAAS,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,YAAY,CAAC,CAAC,QAAQ,EAAE;AAC7D,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,QAAQ,EAAE;CAC5D,CAAC;AACF,IAAI,QAAQ,GAAG;AACb,aAAS;AACP,cAAU,EAAE,MAAM;AAClB,OAAG,EAAC,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,iBAAiB,CAAC;GACnD;AACD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;CACtD,CAAC;AACF,IAAI,QAAQ,GAAG;AACb,aAAS;AACP,cAAU,EAAE,UAAU;AACtB,OAAG,EAAC,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,gBAAgB,CAAC;GAClD;AACD,YAAQ,EAAE,CAAC,YAAY,CAAC,SAAS,GAAG,eAAe,CAAC;CACrD,CAAC;;AAEF,IAAI,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;AAChC,IAAI,QAAQ,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACrC,SAAS,OAAO,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE;AACjC,MAAI,GAAG,GAAG,IAAI,UAAO,CAAC;AACtB,MAAI,IAAI,GAAG,IAAI,WAAQ,CAAC;AACxB,GAAC,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,EAAE;AACtC,KAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;AAEV,QAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AACjD,QAAI,OAAO,GAAG,UAAU,CAAC,aAAa,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AACrD,KAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,yBAAyB,CAAC,CAAC;AACnH,KAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,8BAA8B,CAAC,CAAC;AAC1H,KAAC,CAAC,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,2BAA2B,CAAC,CAAC;AACvH,KAAC,CAAC,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,gCAAgC,CAAC,CAAC;AAC9H,SAAK,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AAC/C,WAAO,GAAG,UAAU,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;AACnD,KAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,yCAAyC,CAAC,CAAC;AACjI,KAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,8CAA8C,CAAC,CAAC;AACxI,KAAC,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,2CAA2C,CAAC,CAAC;AACrI,KAAC,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,gDAAgD,CAAC,CAAC;GAE7I,CAAC,CAAC;CACJ;AACD,SAAS,MAAM,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE;AAChC,SAAO,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;AAC1B,SAAO,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE,IAAI,MAAM,CAAC,yBAAyB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACpG,MAAI,SAAS,GAAG,SAAS,CAAC,IAAI,UAAO,CAAC,CAAC;AACvC,MAAI,CAAC,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;AACvC,MAAI,IAAI,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACzB,MAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACb,MAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,MAAM,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;AACnF,SAAO,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;CACzC;AACD,SAAS,aAAa,CAAC,IAAI,EAAE,OAAO,EAAE;AACpC,SAAO;AACL,cAAQ,UAAU,CAAC,IAAI,UAAO,EAAE,OAAO,CAAC;AACxC,eAAS,UAAU,CAAC,IAAI,WAAQ,EAAE,OAAO,CAAC;GAC3C,CAAC;CACH;AACD,SAAS,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE;AAChC,MAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AACnD,WAAO;AACL,SAAG,EAAE,GAAG;AACR,aAAO,EAAE,OAAO;KACjB,CAAC;GACH;AACD,MAAI,GAAG,GAAG;AACR,OAAG,EAAE,GAAG,CAAC,GAAG;AACZ,WAAO,EAAC,OAAO;GAChB,CAAC;AACF,MAAI,YAAY,IAAI,GAAG,EAAE;AACvB,OAAG,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;GACjC;AACD,SAAO,GAAG,CAAC;CACZ;AACD,SAAS,OAAO,CAAC,CAAC,EAAE;AAClB,MAAI,CAAC,MAAM,GAAG,CAAC,EAAE,UAAU,CAAC,EAAE;AAC5B,UAAM,CAAC,WAAW,EAAE,IAAI,MAAM,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1D,UAAM,CAAC,OAAO,EAAE,IAAI,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;AAC5C,UAAM,CAAC,OAAO,EAAE,IAAI,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;AAC5C,UAAM,CAAC,UAAU,EAAE,IAAI,MAAM,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC,CAAC;AAC3D,UAAM,CAAC,QAAQ,EAAE,IAAI,MAAM,CAAC,wBAAwB,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1D,UAAM,CAAC,aAAa,EAAE,IAAI,MAAM,CAAC,mCAAmC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1E,UAAM,CAAC,QAAQ,EAAE,IAAI,MAAM,CAAC,qCAAqC,CAAC,EAAE,CAAC,CAAC,CAAC;GACxE,CAAC,CAAC;CACJ;;AAED,IAAI,CAAC,GAAG,CAAC,CAAC;AACV,IAAI,GAAG,GAAG,EAAE,CAAC;AACb,OAAO,EAAE,CAAC,IAAI,EAAE,EAAE;AAChB,SAAO,CAAC,CAAC,CAAC,CAAC;CACZ","file":"index-compiled.js","sourcesContent":["var test = require('tape');\nvar fs = require('fs');\nvar constants = require('constants');\nvar parseKeys = require('parse-asn1');\nrequire('./nodeTests');\nvar priv1024 = fs.readFileSync(__dirname + '/rsa.1024.priv');\nvar rsa1024 = {\n  private: fs.readFileSync(__dirname + '/rsa.1024.priv'),\n  public: fs.readFileSync(__dirname + '/rsa.1024.pub')\n};\nvar rsa1024priv = {\n  private: fs.readFileSync(__dirname + '/rsa.1024.priv'),\n  public: fs.readFileSync(__dirname + '/rsa.1024.priv')\n};\nvar rsa1024 = {\n  private: fs.readFileSync(__dirname + '/rsa.1024.priv'),\n  public: fs.readFileSync(__dirname + '/rsa.1024.pub')\n};\nvar rsa2028 = {\n  private: fs.readFileSync(__dirname + '/rsa.2028.priv'),\n  public: fs.readFileSync(__dirname + '/rsa.2028.pub')\n};\nvar nonrsa1024 = {\n  private: fs.readFileSync(__dirname + '/1024.priv'),\n  public: fs.readFileSync(__dirname + '/1024.pub')\n};\nvar nonrsa1024str = {\n  private: fs.readFileSync(__dirname + '/1024.priv').toString(),\n  public: fs.readFileSync(__dirname + '/1024.pub').toString()\n};\nvar pass1024 = {\n  private: {\n    passphrase: 'fooo',\n    key:fs.readFileSync(__dirname + '/pass.1024.priv')\n  },\n  public: fs.readFileSync(__dirname + '/pass.1024.pub')\n};\nvar pass2028 = {\n  private: {\n    passphrase: 'password',\n    key:fs.readFileSync(__dirname + '/rsa.pass.priv')\n  },\n  public: fs.readFileSync(__dirname + '/rsa.pass.pub')\n};\n\nvar nodeCrypto = require('../');\nvar myCrypto = require('../browser');\nfunction _testIt(keys, message, t) {\n  var pub = keys.public;\n  var priv = keys.private;\n  t.test(message.toString(), function (t) {\n    t.plan(8);\n\n    var myEnc = myCrypto.publicEncrypt(pub, message);\n    var nodeEnc = nodeCrypto.publicEncrypt(pub, message);\n    t.equals(myCrypto.privateDecrypt(priv, myEnc).toString('hex'), message.toString('hex'), 'my decrypter my message');\n    t.equals(myCrypto.privateDecrypt(priv, nodeEnc).toString('hex'), message.toString('hex'), 'my decrypter node\\'s message');\n    t.equals(nodeCrypto.privateDecrypt(priv, myEnc).toString('hex'), message.toString('hex'), 'node decrypter my message');\n    t.equals(nodeCrypto.privateDecrypt(priv, nodeEnc).toString('hex'), message.toString('hex'), 'node decrypter node\\'s message');\n    myEnc = myCrypto.privateEncrypt(priv, message);\n    nodeEnc = nodeCrypto.privateEncrypt(priv, message);\n    t.equals(myCrypto.publicDecrypt(pub, myEnc).toString('hex'), message.toString('hex'), 'reverse methods my decrypter my message');\n    t.equals(myCrypto.publicDecrypt(pub, nodeEnc).toString('hex'), message.toString('hex'), 'reverse methods my decrypter node\\'s message');\n    t.equals(nodeCrypto.publicDecrypt(pub, myEnc).toString('hex'), message.toString('hex'), 'reverse methods node decrypter my message');\n    t.equals(nodeCrypto.publicDecrypt(pub, nodeEnc).toString('hex'), message.toString('hex'), 'reverse methods node decrypter node\\'s message');\n\n  });\n}\nfunction testIt(keys, message, t) {\n  _testIt(keys, message, t);\n  _testIt(paddingObject(keys, 1), Buffer.concat([message, new Buffer(' with RSA_PKCS1_PADDING')]), t);\n  var parsedKey = parseKeys(keys.public);\n  var k = parsedKey.modulus.byteLength();\n  var zBuf = new Buffer(k);\n  zBuf.fill(0);\n  var msg = Buffer.concat([zBuf, message, new Buffer(' with no padding')]).slice(-k);\n  _testIt(paddingObject(keys, 3), msg, t);\n}\nfunction paddingObject(keys, padding) {\n  return {\n    public: addPadding(keys.public, padding),\n    private: addPadding(keys.private, padding)\n  };\n}\nfunction addPadding(key, padding) {\n  if (typeof key === 'string' || Buffer.isBuffer(key)) {\n    return {\n      key: key,\n      padding: padding\n    };\n  }\n  var out = {\n    key: key.key,\n    padding:padding\n  };\n  if ('passphrase' in key) {\n    out.passphrase = key.passphrase;\n  }\n  return out;\n}\nfunction testRun(i) {\n  test('run ' + i, function (t) {\n    testIt(rsa1024priv, new Buffer('1024 2 private keys'), t);\n    testIt(rsa1024, new Buffer('1024 keys'), t);\n    testIt(rsa2028, new Buffer('2028 keys'), t);\n    testIt(nonrsa1024, new Buffer('1024 keys non-rsa key'), t);\n    testIt(pass1024, new Buffer('1024 keys and password'), t);\n    testIt(nonrsa1024str, new Buffer('1024 keys non-rsa key as a string'), t);\n    testIt(pass2028, new Buffer('2028 rsa key with variant passwords'), t);\n  });\n}\n\nvar i = 0;\nvar num = 20;\nwhile (++i <= 20) {\n  testRun(i);\n}\n"]}