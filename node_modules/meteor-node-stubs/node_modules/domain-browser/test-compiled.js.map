{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["/* eslint handle-callback-err:0, no-magic-numbers:0, no-unused-vars:0 */\n'use strict'\n\n// Import\nconst events = require('events')\nconst equal = require('assert-helpers').equal\nconst joe = require('joe')\nconst domain = require('./')\n\n// =====================================\n// Tests\n\njoe.describe('domain-browser', function (describe, it) {\n\tit('should work on throws', function (done) {\n\t\tconst d = domain.create()\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\tdone()\n\t\t})\n\t\td.run(function () {\n\t\t\tthrow new Error('a thrown error')\n\t\t})\n\t})\n\n\tit('should be able to add emitters', function (done) {\n\t\tconst d = domain.create()\n\t\tconst emitter = new events.EventEmitter()\n\n\t\td.add(emitter)\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'an emitted error', 'error message')\n\t\t\tdone()\n\t\t})\n\n\t\temitter.emit('error', new Error('an emitted error'))\n\t})\n\n\tit('should be able to remove emitters', function (done) {\n\t\tconst emitter = new events.EventEmitter()\n\t\tconst d = domain.create()\n\t\tlet domainGotError = false\n\n\t\td.add(emitter)\n\t\td.on('error', function (err) {\n\t\t\tdomainGotError = true\n\t\t})\n\n\t\temitter.on('error', function (err) {\n\t\t\tequal(err && err.message, 'This error should not go to the domain', 'error message')\n\n\t\t\t// Make sure nothing race condition-y is happening\n\t\t\tsetTimeout(function () {\n\t\t\t\tequal(domainGotError, false, 'no domain error')\n\t\t\t\tdone()\n\t\t\t}, 0)\n\t\t})\n\n\t\td.remove(emitter)\n\t\temitter.emit('error', new Error('This error should not go to the domain'))\n\t})\n\n\tit('bind should work', function (done) {\n\t\tconst d = domain.create()\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\tdone()\n\t\t})\n\t\td.bind(function (err, a, b) {\n\t\t\tequal(err && err.message, 'a passed error', 'error message')\n\t\t\tequal(a, 2, 'value of a')\n\t\t\tequal(b, 3, 'value of b')\n\t\t\tthrow new Error('a thrown error')\n\t\t})(new Error('a passed error'), 2, 3)\n\t})\n\n\tit('intercept should work', function (done) {\n\t\tconst d = domain.create()\n\t\tlet count = 0\n\t\td.on('error', function (err) {\n\t\t\tif ( count === 0 ) {\n\t\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\t}\n\t\t\telse if ( count === 1 ) {\n\t\t\t\tequal(err && err.message, 'a passed error', 'error message')\n\t\t\t\tdone()\n\t\t\t}\n\t\t\tcount++\n\t\t})\n\n\t\td.intercept(function (a, b) {\n\t\t\tequal(a, 2, 'value of a')\n\t\t\tequal(b, 3, 'value of b')\n\t\t\tthrow new Error('a thrown error')\n\t\t})(null, 2, 3)\n\n\t\td.intercept(function (a, b) {\n\t\t\tthrow new Error('should never reach here')\n\t\t})(new Error('a passed error'), 2, 3)\n\t})\n})\n"]}