{"version":3,"sources":["_collection-weak.js"],"names":[],"mappings":"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","file":"_collection-weak-compiled.js","sourcesContent":["'use strict';\nvar redefineAll       = require('./_redefine-all')\n  , getWeak           = require('./_meta').getWeak\n  , anObject          = require('./_an-object')\n  , isObject          = require('./_is-object')\n  , anInstance        = require('./_an-instance')\n  , forOf             = require('./_for-of')\n  , createArrayMethod = require('./_array-methods')\n  , $has              = require('./_has')\n  , arrayFind         = createArrayMethod(5)\n  , arrayFindIndex    = createArrayMethod(6)\n  , id                = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function(that){\n  return that._l || (that._l = new UncaughtFrozenStore);\n};\nvar UncaughtFrozenStore = function(){\n  this.a = [];\n};\nvar findUncaughtFrozen = function(store, key){\n  return arrayFind(store.a, function(it){\n    return it[0] === key;\n  });\n};\nUncaughtFrozenStore.prototype = {\n  get: function(key){\n    var entry = findUncaughtFrozen(this, key);\n    if(entry)return entry[1];\n  },\n  has: function(key){\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function(key, value){\n    var entry = findUncaughtFrozen(this, key);\n    if(entry)entry[1] = value;\n    else this.a.push([key, value]);\n  },\n  'delete': function(key){\n    var index = arrayFindIndex(this.a, function(it){\n      return it[0] === key;\n    });\n    if(~index)this.a.splice(index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function(wrapper, NAME, IS_MAP, ADDER){\n    var C = wrapper(function(that, iterable){\n      anInstance(that, C, NAME, '_i');\n      that._i = id++;      // collection id\n      that._l = undefined; // leak store for uncaught frozen objects\n      if(iterable != undefined)forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.3.3.2 WeakMap.prototype.delete(key)\n      // 23.4.3.3 WeakSet.prototype.delete(value)\n      'delete': function(key){\n        if(!isObject(key))return false;\n        var data = getWeak(key);\n        if(data === true)return uncaughtFrozenStore(this)['delete'](key);\n        return data && $has(data, this._i) && delete data[this._i];\n      },\n      // 23.3.3.4 WeakMap.prototype.has(key)\n      // 23.4.3.4 WeakSet.prototype.has(value)\n      has: function has(key){\n        if(!isObject(key))return false;\n        var data = getWeak(key);\n        if(data === true)return uncaughtFrozenStore(this).has(key);\n        return data && $has(data, this._i);\n      }\n    });\n    return C;\n  },\n  def: function(that, key, value){\n    var data = getWeak(anObject(key), true);\n    if(data === true)uncaughtFrozenStore(that).set(key, value);\n    else data[that._i] = value;\n    return that;\n  },\n  ufstore: uncaughtFrozenStore\n};"]}