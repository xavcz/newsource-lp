{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _fbjsLibExecutionEnvironment = require('fbjs/lib/ExecutionEnvironment');\n\nvar _fbjsLibExecutionEnvironment2 = _interopRequireDefault(_fbjsLibExecutionEnvironment);\n\nvar _fbjsLibShallowEqual = require('fbjs/lib/shallowEqual');\n\nvar _fbjsLibShallowEqual2 = _interopRequireDefault(_fbjsLibShallowEqual);\n\nmodule.exports = function withSideEffect(reducePropsToState, handleStateChangeOnClient, mapStateOnServer) {\n  if (typeof reducePropsToState !== 'function') {\n    throw new Error('Expected reducePropsToState to be a function.');\n  }\n  if (typeof handleStateChangeOnClient !== 'function') {\n    throw new Error('Expected handleStateChangeOnClient to be a function.');\n  }\n  if (typeof mapStateOnServer !== 'undefined' && typeof mapStateOnServer !== 'function') {\n    throw new Error('Expected mapStateOnServer to either be undefined or a function.');\n  }\n\n  function getDisplayName(WrappedComponent) {\n    return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n  }\n\n  return function wrap(WrappedComponent) {\n    if (typeof WrappedComponent !== 'function') {\n      throw new Error('Expected WrappedComponent to be a React component.');\n    }\n\n    var mountedInstances = [];\n    var state = undefined;\n\n    function emitChange() {\n      state = reducePropsToState(mountedInstances.map(function (instance) {\n        return instance.props;\n      }));\n\n      if (SideEffect.canUseDOM) {\n        handleStateChangeOnClient(state);\n      } else if (mapStateOnServer) {\n        state = mapStateOnServer(state);\n      }\n    }\n\n    var SideEffect = (function (_Component) {\n      _inherits(SideEffect, _Component);\n\n      function SideEffect() {\n        _classCallCheck(this, SideEffect);\n\n        _Component.apply(this, arguments);\n      }\n\n      SideEffect.peek = function peek() {\n        return state;\n      };\n\n      SideEffect.rewind = function rewind() {\n        if (SideEffect.canUseDOM) {\n          throw new Error('You may ony call rewind() on the server. Call peek() to read the current state.');\n        }\n\n        var recordedState = state;\n        state = undefined;\n        mountedInstances = [];\n        return recordedState;\n      };\n\n      SideEffect.prototype.shouldComponentUpdate = function shouldComponentUpdate(nextProps) {\n        return !_fbjsLibShallowEqual2['default'](nextProps, this.props);\n      };\n\n      SideEffect.prototype.componentWillMount = function componentWillMount() {\n        mountedInstances.push(this);\n        emitChange();\n      };\n\n      SideEffect.prototype.componentDidUpdate = function componentDidUpdate() {\n        emitChange();\n      };\n\n      SideEffect.prototype.componentWillUnmount = function componentWillUnmount() {\n        var index = mountedInstances.indexOf(this);\n        mountedInstances.splice(index, 1);\n        emitChange();\n      };\n\n      SideEffect.prototype.render = function render() {\n        return _react2['default'].createElement(WrappedComponent, this.props);\n      };\n\n      _createClass(SideEffect, null, [{\n        key: 'displayName',\n\n        // Try to use displayName of wrapped component\n        value: 'SideEffect(' + getDisplayName(WrappedComponent) + ')',\n\n        // Expose canUseDOM so tests can monkeypatch it\n        enumerable: true\n      }, {\n        key: 'canUseDOM',\n        value: _fbjsLibExecutionEnvironment2['default'].canUseDOM,\n        enumerable: true\n      }]);\n\n      return SideEffect;\n    })(_react.Component);\n\n    return SideEffect;\n  };\n};"]}