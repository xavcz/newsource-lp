{"version":3,"sources":["$.microtask.js"],"names":[],"mappings":";;AAAA,IAAI,MAAM,GAAM,OAAO,CAAC,YAAY,CAAC;IACjC,SAAS,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,GAAG;IACnC,QAAQ,GAAI,MAAM,CAAC,gBAAgB,IAAI,MAAM,CAAC,sBAAsB;IACpE,OAAO,GAAK,MAAM,CAAC,OAAO;IAC1B,OAAO,GAAK,MAAM,CAAC,OAAO;IAC1B,MAAM,GAAM,OAAO,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,IAAI,SAAS;IACpD,IAAI;IAAE,IAAI;IAAE,MAAM,CAAC;;AAEvB,IAAI,KAAK,GAAG,SAAR,KAAK,GAAa;AACpB,MAAI,MAAM,EAAE,MAAM,EAAE,EAAE,CAAC;AACvB,MAAG,MAAM,KAAK,MAAM,GAAG,OAAO,CAAC,MAAM,CAAA,AAAC,EAAC;AACrC,WAAO,CAAC,MAAM,GAAG,IAAI,CAAC;AACtB,UAAM,CAAC,IAAI,EAAE,CAAC;GACf;AACD,SAAM,IAAI,EAAC;AACT,UAAM,GAAG,IAAI,CAAC,MAAM,CAAC;AACrB,MAAE,GAAO,IAAI,CAAC,EAAE,CAAC;AACjB,QAAG,MAAM,EAAC,MAAM,CAAC,KAAK,EAAE,CAAC;AACzB,MAAE,EAAE,CAAC;AACL,QAAG,MAAM,EAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AACxB,QAAI,GAAG,IAAI,CAAC,IAAI,CAAC;GAClB,AAAC,IAAI,GAAG,SAAS,CAAC;AACnB,MAAG,MAAM,EAAC,MAAM,CAAC,KAAK,EAAE,CAAC;CAC1B,CAAC;;;AAGF,IAAG,MAAM,EAAC;AACR,QAAM,GAAG,YAAU;AACjB,WAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;GACzB,CAAC;;CAEH,MAAM,IAAG,QAAQ,EAAC;AACjB,QAAI,MAAM,GAAG,CAAC;QACV,IAAI,GAAK,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;AACzC,QAAI,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,EAAC,aAAa,EAAE,IAAI,EAAC,CAAC,CAAC;AACzD,UAAM,GAAG,YAAU;AACjB,UAAI,CAAC,IAAI,GAAG,MAAM,GAAG,CAAC,MAAM,CAAC;KAC9B,CAAC;;GAEH,MAAM,IAAG,OAAO,IAAI,OAAO,CAAC,OAAO,EAAC;AACnC,YAAM,GAAG,YAAU;AACjB,eAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;OAC/B,CAAC;;;;;;;KAOH,MAAM;AACL,cAAM,GAAG,YAAU;;AAEjB,mBAAS,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SAC/B,CAAC;OACH;;AAED,MAAM,CAAC,OAAO,GAAG,SAAS,IAAI,CAAC,EAAE,EAAC;AAChC,MAAI,IAAI,GAAG,EAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,IAAI,OAAO,CAAC,MAAM,EAAC,CAAC;AACvE,MAAG,IAAI,EAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACzB,MAAG,CAAC,IAAI,EAAC;AACP,QAAI,GAAG,IAAI,CAAC;AACZ,UAAM,EAAE,CAAC;GACV,AAAC,IAAI,GAAG,IAAI,CAAC;CACf,CAAC","file":"$.microtask-compiled.js","sourcesContent":["var global    = require('./$.global')\n  , macrotask = require('./$.task').set\n  , Observer  = global.MutationObserver || global.WebKitMutationObserver\n  , process   = global.process\n  , Promise   = global.Promise\n  , isNode    = require('./$.cof')(process) == 'process'\n  , head, last, notify;\n\nvar flush = function(){\n  var parent, domain, fn;\n  if(isNode && (parent = process.domain)){\n    process.domain = null;\n    parent.exit();\n  }\n  while(head){\n    domain = head.domain;\n    fn     = head.fn;\n    if(domain)domain.enter();\n    fn(); // <- currently we use it only for Promise - try / catch not required\n    if(domain)domain.exit();\n    head = head.next;\n  } last = undefined;\n  if(parent)parent.enter();\n};\n\n// Node.js\nif(isNode){\n  notify = function(){\n    process.nextTick(flush);\n  };\n// browsers with MutationObserver\n} else if(Observer){\n  var toggle = 1\n    , node   = document.createTextNode('');\n  new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\n  notify = function(){\n    node.data = toggle = -toggle;\n  };\n// environments with maybe non-completely correct, but existent Promise\n} else if(Promise && Promise.resolve){\n  notify = function(){\n    Promise.resolve().then(flush);\n  };\n// for other environments - macrotask based on:\n// - setImmediate\n// - MessageChannel\n// - window.postMessag\n// - onreadystatechange\n// - setTimeout\n} else {\n  notify = function(){\n    // strange IE + webpack dev server bug - use .call(global)\n    macrotask.call(global, flush);\n  };\n}\n\nmodule.exports = function asap(fn){\n  var task = {fn: fn, next: undefined, domain: isNode && process.domain};\n  if(last)last.next = task;\n  if(!head){\n    head = task;\n    notify();\n  } last = task;\n};"]}