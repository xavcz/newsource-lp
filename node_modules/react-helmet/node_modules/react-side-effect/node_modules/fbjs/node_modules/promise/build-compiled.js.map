{"version":3,"sources":["build.js"],"names":[],"mappings":"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","file":"build-compiled.js","sourcesContent":["'use strict';\n\nvar fs = require('fs');\nvar rimraf = require('rimraf');\nvar acorn = require('acorn');\nvar walk = require('acorn/dist/walk');\n\nvar ids = [];\nvar names = {};\n\nfunction getIdFor(name) {\n  if (name in names) return names[name];\n  var id;\n  do {\n    id = '_' + Math.floor(Math.random() * 100);\n  } while (ids.indexOf(id) !== -1)\n  ids.push(id);\n  names[name] = id;\n  return id;\n}\n\nfunction fixup(src) {\n  var ast = acorn.parse(src);\n  src = src.split('');\n  walk.simple(ast, {\n    MemberExpression: function (node) {\n      if (node.computed) return;\n      if (node.property.type !== 'Identifier') return;\n      if (node.property.name[0] !== '_') return;\n      replace(node.property, getIdFor(node.property.name));\n    }\n  });\n  function source(node) {\n    return src.slice(node.start, node.end).join('');\n  }\n  function replace(node, str) {\n    for (var i = node.start; i < node.end; i++) {\n      src[i] = '';\n    }\n    src[node.start] = str;\n  }\n  return src.join('');\n}\nrimraf.sync(__dirname + '/lib/');\nfs.mkdirSync(__dirname + '/lib/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  fs.writeFileSync(__dirname + '/lib/' + filename, out);\n});\n\nrimraf.sync(__dirname + '/domains/');\nfs.mkdirSync(__dirname + '/domains/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/require\\(\\'asap\\/raw\\'\\)/g, \"require('asap')\");\n  fs.writeFileSync(__dirname + '/domains/' + filename, out);\n});\n\nrimraf.sync(__dirname + '/setimmediate/');\nfs.mkdirSync(__dirname + '/setimmediate/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/var asap \\= require\\(\\'([a-z\\/]+)\\'\\);/g, '');\n  out = out.replace(/asap/g, \"setImmediate\");\n  fs.writeFileSync(__dirname + '/setimmediate/' + filename, out);\n});\n"]}