{"version":3,"sources":["core.js"],"names":[],"mappings":"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","file":"core-compiled.js","sourcesContent":["'use strict';\n\nvar asap = require('asap/raw');\n\nfunction noop() {}\n\n// States:\n//\n// 0 - pending\n// 1 - fulfilled with _value\n// 2 - rejected with _value\n// 3 - adopted the state of another promise, _value\n//\n// once the state is no longer pending (0) it is immutable\n\n// All `_` prefixed properties will be reduced to `_{random number}`\n// at build time to obfuscate them and discourage their use.\n// We don't use symbols or Object.defineProperty to fully hide them\n// because the performance isn't good enough.\n\n\n// to avoid using try/catch inside critical functions, we\n// extract them to here.\nvar LAST_ERROR = null;\nvar IS_ERROR = {};\nfunction getThen(obj) {\n  try {\n    return obj.then;\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nfunction tryCallOne(fn, a) {\n  try {\n    return fn(a);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\nfunction tryCallTwo(fn, a, b) {\n  try {\n    fn(a, b);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nmodule.exports = Promise;\n\nfunction Promise(fn) {\n  if (typeof this !== 'object') {\n    throw new TypeError('Promises must be constructed via new');\n  }\n  if (typeof fn !== 'function') {\n    throw new TypeError('not a function');\n  }\n  this._deferredState = 0;\n  this._state = 0;\n  this._value = null;\n  this._deferreds = null;\n  if (fn === noop) return;\n  doResolve(fn, this);\n}\nPromise._onHandle = null;\nPromise._onReject = null;\nPromise._noop = noop;\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  if (this.constructor !== Promise) {\n    return safeThen(this, onFulfilled, onRejected);\n  }\n  var res = new Promise(noop);\n  handle(this, new Handler(onFulfilled, onRejected, res));\n  return res;\n};\n\nfunction safeThen(self, onFulfilled, onRejected) {\n  return new self.constructor(function (resolve, reject) {\n    var res = new Promise(noop);\n    res.then(resolve, reject);\n    handle(self, new Handler(onFulfilled, onRejected, res));\n  });\n};\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (Promise._onHandle) {\n    Promise._onHandle(self);\n  }\n  if (self._state === 0) {\n    if (self._deferredState === 0) {\n      self._deferredState = 1;\n      self._deferreds = deferred;\n      return;\n    }\n    if (self._deferredState === 1) {\n      self._deferredState = 2;\n      self._deferreds = [self._deferreds, deferred];\n      return;\n    }\n    self._deferreds.push(deferred);\n    return;\n  }\n  handleResolved(self, deferred);\n}\n\nfunction handleResolved(self, deferred) {\n  asap(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      if (self._state === 1) {\n        resolve(deferred.promise, self._value);\n      } else {\n        reject(deferred.promise, self._value);\n      }\n      return;\n    }\n    var ret = tryCallOne(cb, self._value);\n    if (ret === IS_ERROR) {\n      reject(deferred.promise, LAST_ERROR);\n    } else {\n      resolve(deferred.promise, ret);\n    }\n  });\n}\nfunction resolve(self, newValue) {\n  // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n  if (newValue === self) {\n    return reject(\n      self,\n      new TypeError('A promise cannot be resolved with itself.')\n    );\n  }\n  if (\n    newValue &&\n    (typeof newValue === 'object' || typeof newValue === 'function')\n  ) {\n    var then = getThen(newValue);\n    if (then === IS_ERROR) {\n      return reject(self, LAST_ERROR);\n    }\n    if (\n      then === self.then &&\n      newValue instanceof Promise\n    ) {\n      self._state = 3;\n      self._value = newValue;\n      finale(self);\n      return;\n    } else if (typeof then === 'function') {\n      doResolve(then.bind(newValue), self);\n      return;\n    }\n  }\n  self._state = 1;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  if (Promise._onReject) {\n    Promise._onReject(self, newValue);\n  }\n  finale(self);\n}\nfunction finale(self) {\n  if (self._deferredState === 1) {\n    handle(self, self._deferreds);\n    self._deferreds = null;\n  }\n  if (self._deferredState === 2) {\n    for (var i = 0; i < self._deferreds.length; i++) {\n      handle(self, self._deferreds[i]);\n    }\n    self._deferreds = null;\n  }\n}\n\nfunction Handler(onFulfilled, onRejected, promise){\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, promise) {\n  var done = false;\n  var res = tryCallTwo(fn, function (value) {\n    if (done) return;\n    done = true;\n    resolve(promise, value);\n  }, function (reason) {\n    if (done) return;\n    done = true;\n    reject(promise, reason);\n  })\n  if (!done && res === IS_ERROR) {\n    done = true;\n    reject(promise, LAST_ERROR);\n  }\n}\n"]}