{"version":3,"sources":["rewrite-modules.js"],"names":[],"mappings":"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","file":"rewrite-modules-compiled.js","sourcesContent":["/**\n * Copyright 2013-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n'use strict';\n\n/**\n * Rewrites module string literals according to the `_moduleMap` babel option.\n * This allows other npm packages to be published and used directly without\n * being a part of the same build.\n */\nfunction mapModule(context, module) {\n  var moduleMap = context.state.opts._moduleMap || {};\n  if (moduleMap.hasOwnProperty(module)) {\n    return moduleMap[module];\n  }\n  // Jest understands the haste module system, so leave modules intact.\n  if (process.env.NODE_ENV !== 'test') {\n    var modulePrefix = context.state.opts._modulePrefix;\n    if (modulePrefix == null) {\n      modulePrefix = './';\n    }\n    return modulePrefix + module;\n  }\n}\n\nmodule.exports = function(babel) {\n  var t = babel.types;\n\n  /**\n   * Transforms `require('Foo')` and `require.requireActual('Foo')`.\n   */\n  function transformRequireCall(context, call) {\n    if (\n      !t.isIdentifier(call.callee, {name: 'require'}) &&\n      !(\n        t.isMemberExpression(call.callee) &&\n        t.isIdentifier(call.callee.object, {name: 'require'}) &&\n        t.isIdentifier(call.callee.property, {name: 'requireActual'})\n      )\n    ) {\n      return;\n    }\n    var moduleArg = call.arguments[0];\n    if (moduleArg && moduleArg.type === 'Literal') {\n      var module = mapModule(context, moduleArg.value);\n      if (module) {\n        return t.callExpression(\n          call.callee,\n          [t.literal(module)]\n        );\n      }\n    }\n  }\n\n  /**\n   * Transforms either individual or chained calls to `jest.dontMock('Foo')`,\n   * `jest.mock('Foo')`, and `jest.genMockFromModule('Foo')`.\n   */\n  function transformJestCall(context, call) {\n    if (!t.isMemberExpression(call.callee)) {\n      return;\n    }\n    var object;\n    var member = call.callee;\n    if (t.isIdentifier(member.object, {name: 'jest'})) {\n      object = member.object;\n    } else if (t.isCallExpression(member.object)) {\n      object = transformJestCall(context, member.object);\n    }\n    if (!object) {\n      return;\n    }\n    var args = call.arguments;\n    if (\n      args[0] &&\n      args[0].type === 'Literal' &&\n      (\n        t.isIdentifier(member.property, {name: 'dontMock'}) ||\n        t.isIdentifier(member.property, {name: 'mock'}) ||\n        t.isIdentifier(member.property, {name: 'genMockFromModule'})\n      )\n    ) {\n      var module = mapModule(context, args[0].value);\n      if (module) {\n        args = [t.literal(module)];\n      }\n    }\n    return t.callExpression(\n      t.memberExpression(object, member.property),\n      args\n    );\n  }\n\n  return new babel.Transformer('fbjs.rewrite-modules', {\n    CallExpression: {\n      exit: function(node, parent) {\n        return (\n          transformRequireCall(this, node) ||\n          transformJestCall(this, node)\n        );\n      }\n    }\n  });\n};\n"]}